import{_ as l,r as t,c as s,a as e,b as d,w as c,F as i,e as n,d as a,o as r}from"./app.2a01fc36.js";var p="/assets/01.049823d4.png",h="/assets/02.14bd0e14.png",A="/assets/03.27117c2c.png",g="/assets/04.07ab0157.png",u="/assets/05.1a3dcf60.png",b="/assets/06.23118a5c.png",v="/assets/07.059357b9.png",m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAABICAYAAAAqPKG2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAOmSURBVHhe7Z0/juIwFIdf9i5E03CA5AagLaaZerqkhp6KPqlJt/UKtMUq3AAOMA2CvUvWDg6QGC8kaxze432SNQ4o//hiv0B+0niFABj0fFN/GeRcFblarVSPwQKPSCKwSCKwSCKwSCKwSCKwSCJYFHmANPQgXqtFxilPNiLXEHseeKqF6UG97pLjBel5sTgaPDyVyHU8BsgLkL8aFvsEYPoJTl2uYyHwE+AjUi/g4QEiqytatrCViNGigMVILQy+w0ewhZ+/mxtQ2w9T0dNZx9W+ZWszqsR25/I62sDkTb2ECOsis7EPu5kaVfkQpn7XKeoP7LYAw7eBWr7NIQ3h17vat2h5lMHYIFxnAJPNAqrrCB3ihDWWy6XqtWFfJAEUUa4WS/IigqBI9lUf5JOWegsSsaZOHpnfu5s8uthGi/3L9SASa+DBYY0cwUKNlFrbTMRYqCNH1jgLIPmhv/dPDimEp2lVtHGm3pDcv3+MOBRZvyM9tcbUJyX6U4BkL2pVO4uQfpYrniWJYX3mvv1j5aEi5V1oFs2UkDtGhLhrvC3R9PWgWVOFuBcakfJkNP6nRspNnlq9YN7AUMOu1Kqyfor3tM2Xta1aT9TmPCmCFnW22m694aiVFkW6Y58EaD5gVziskRZQNzP+dCi+7yH+qvAAcIkcTGBTziIssQkukYwRFkkEFkkEFkkEFkkEFkkEFkkEFkkEiyKPP2Zz+KofnmxE9hu+qsdE+gp/deOpRPYdvpKZoXLfZcthOPXRzDAPEFk9L5QNU/iqyQjeI4CvHY5RaV0k3vBVg0MK8yyCWbuYQn+IE9Z45fDV5cPl4HjgKHBYI3GEry7r5Gzng4ekSDoUiS98NToWyW5Ts2vECWvYmlrLaapNbqfM3FRTsYkqG9SMehynzvPu1FTaeXpW+2lz/D1iXaS8Nk6t1YdgqGHOwlf68WOqkRZFuoPDVzpP9YPATTh8ZQSXSA5fGcElkjHCIonAIonAIonAIonAIolgUSRHPfrkisj+TPQdtSAV9Yi9ueq5p++oBamoRwZb1etK96hHHVPUgqMe19Cn1iBRnW5Yi3p0iFpw1OMC+Sipz6iH1ajFK0c9FjKG+BAcRC046nHBYKI6tnl01IKjHhq9RT1qmKIW1ZN8jnpcYl2kvDZOrdWHoK9vqlEc9dCxKNIdHPXQ0WvkM8NRDyO4RHLUwwgukYwRFkkE/v+RROARSQQWSQQWSQQWSQQWSQQWSQQWSQKAv/gu9ljrrpaeAAAAAElFTkSuQmCC",x="data:image/png;base64,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",f="/assets/10.e0b10d57.png",_="/assets/11.0f95699c.png",k="/assets/12.9736fcb6.png",y="/assets/13.7ee2add9.png",E="/assets/14.b8b67d35.png",B="/assets/15.6180b717.png",M="/assets/16.b8388534.png",q="/assets/17.dc0f5a33.png",z="/assets/18.d68e2183.png",j="/assets/19.98887597.png",w="/assets/20.1daefac4.png",J="/assets/21.b31c4ddc.png",V="/assets/22.1dc24cfb.png",F="/assets/23.a79b1905.png",T="/assets/24.1ff7292d.png",U="/assets/25.c0ff3526.png";const W={},C=n('<h2 id="_1-\u4ECE-java-\u4EE3\u7801\u5230-cpu-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_1-\u4ECE-java-\u4EE3\u7801\u5230-cpu-\u6307\u4EE4" aria-hidden="true">#</a> 1. \u4ECE <code>Java</code> \u4EE3\u7801\u5230 <code>CPU</code> \u6307\u4EE4</h2><p><img src="'+p+'" alt="" loading="lazy"></p><p>\u5982\u4E0A\u56FE\uFF1A</p><ol><li>\u6700\u5F00\u59CB\uFF0C\u6211\u4EEC\u7F16\u5199\u7684 <code>Java</code> \u4EE3\u7801\u662F <code>*.java</code> \u6587\u4EF6\uFF1B</li><li>\u5728\u7F16\u8BD1\uFF08<code>javac</code> \u547D\u4EE4\uFF09\u540E\uFF0C\u4ECE\u521A\u624D\u7684 <code>*.java</code> \u6587\u4EF6\u751F\u6210\u4E00\u4E2A\u65B0\u7684 <code>Java</code> \u5B57\u8282\u7801\u6587\u4EF6\uFF08<code>*.class</code>\uFF09\uFF1B</li><li><code>JVM</code> \u4F1A\u6267\u884C\u521A\u624D\u751F\u6210\u7684\u5B57\u8282\u7801\u6587\u4EF6\uFF08<code>*.class</code>\uFF09\uFF0C\u5E76\u628A\u5B57\u8282\u7801\u6587\u4EF6\u8F6C\u6362\u6210\u673A\u5668\u6307\u4EE4\uFF1B</li><li>\u673A\u5668\u6307\u4EE4\u53EF\u4EE5\u76F4\u63A5\u5728 <code>CPU</code> \u4E0A\u8FD0\u884C\uFF0C\u4E5F\u5C31\u662F\u6700\u7EC8\u7684\u7A0B\u5E8F\u6267\u884C\u3002</li></ol><h2 id="_2-jvm-\u5185\u5B58\u7ED3\u6784-java-\u5185\u5B58\u6A21\u578B-java-\u5BF9\u8C61\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#_2-jvm-\u5185\u5B58\u7ED3\u6784-java-\u5185\u5B58\u6A21\u578B-java-\u5BF9\u8C61\u6A21\u578B" aria-hidden="true">#</a> 2. <code>JVM</code> \u5185\u5B58\u7ED3\u6784 &amp; <code>Java</code> \u5185\u5B58\u6A21\u578B &amp; <code>Java</code> \u5BF9\u8C61\u6A21\u578B</h2><p>\u8FD9\u662F\u4E09\u4E2A\u622A\u7136\u4E0D\u540C\u7684\u6982\u5FF5\uFF0C\u5176\u4E2D\uFF1A</p><ol><li><code>JVM</code> \u5185\u5B58\u7ED3\u6784\uFF0C\u548C <code>Java</code> \u865A\u62DF\u673A\u7684\u8FD0\u884C\u65F6\u533A\u57DF\u6709\u5173\u3002</li><li><code>Java</code> \u5185\u5B58\u6A21\u578B\uFF0C\u548C <code>Java</code> \u7684\u5E76\u53D1\u7F16\u7A0B\u6709\u5173\u3002</li><li><code>Java</code> \u5BF9\u8C61\u6A21\u578B\uFF0C\u548C <code>Java</code> \u5BF9\u8C61\u5728\u865A\u62DF\u673A\u4E2D\u7684\u8868\u73B0\u5F62\u5F0F\u6709\u5173\u3002</li></ol><h3 id="_2-1-jvm-\u5185\u5B58\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#_2-1-jvm-\u5185\u5B58\u7ED3\u6784" aria-hidden="true">#</a> 2.1 <code>JVM</code> \u5185\u5B58\u7ED3\u6784</h3><p><img src="'+h+'" alt="" loading="lazy"></p><p>\u5982\u4E0A\u56FE\uFF0C<code>JVM</code> \u5185\u5B58\u7ED3\u6784\u5305\u62EC\uFF1A</p><ol><li>\u5806\uFF08<code>heap</code>\uFF09</li><li>\u865A\u62DF\u673A\u6808\uFF08<code>VM stack</code>\uFF09\uFF0C\u5373\u56FE\u4E2D\u7684 <code>Java</code> \u6808</li><li>\u65B9\u6CD5\u533A\uFF08<code>method</code>\uFF09</li><li>\u672C\u5730\u65B9\u6CD5\u6808</li><li>\u7A0B\u5E8F\u8BA1\u6570\u5668</li></ol><h3 id="_2-2-java-\u5BF9\u8C61\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#_2-2-java-\u5BF9\u8C61\u6A21\u578B" aria-hidden="true">#</a> 2.2 <code>Java</code> \u5BF9\u8C61\u6A21\u578B</h3><p><code>Java</code> \u5BF9\u8C61\u6A21\u578B\u5C31\u662F <code>Java</code> \u5BF9\u8C61\u81EA\u8EAB\u7684\u5B58\u50A8\u6A21\u578B\u3002</p><p><code>JVM</code> \u4F1A\u7ED9\u4E00\u4E2A\u7C7B\u521B\u5EFA\u4E00\u4E2A <code>instanceKlass</code>\uFF0C\u4FDD\u5B58\u5728\u65B9\u6CD5\u533A\uFF0C\u7528\u6765\u5728 <code>JVM</code> \u5C42\u8868\u793A\u8BE5 <code>Java</code> \u7C7B\u3002</p><p>\u5F53\u6211\u4EEC\u5728 <code>Java</code> \u4EE3\u7801\u4E2D\u4F7F\u7528 <code>new</code> \u521B\u5EFA\u4E00\u4E2A\u5BF9\u8C61\u65F6\uFF0C<code>JVM</code> \u4F1A\u521B\u5EFA\u4E00\u4E2A <code>instanceOopDesc</code> \u5BF9\u8C61\uFF0C\u8FD9\u4E2A\u5BF9\u8C61\u4E2D\u5305\u542B\u4E86\u5BF9\u8C61\u5934\u4EE5\u53CA\u5B9E\u4F8B\u6570\u636E\u3002</p><p><img src="'+A+'" alt="" loading="lazy"></p>',16),P=a("\u53C2\u8003 \u300A\u5185\u5B58\u5206\u914D\u300B \u4E2D\u7684 "),Q=a("\u5BF9\u8C61\u7684\u5185\u5B58\u5E03\u5C40"),Y=a("\u53C2\u8003 \u300A\u5185\u5B58\u5206\u914D\u300B \u4E2D\u7684 "),S=a("\u5BF9\u8C61\u7684\u8BBF\u95EE\u65B9\u5F0F"),N=n('<h2 id="_3-java-\u5185\u5B58\u6A21\u578B-jmm" tabindex="-1"><a class="header-anchor" href="#_3-java-\u5185\u5B58\u6A21\u578B-jmm" aria-hidden="true">#</a> 3. <code>Java</code> \u5185\u5B58\u6A21\u578B\uFF08<code>JMM</code>\uFF09</h2><p><code>JMM</code> \u5373 <code>Java Memory Model</code></p><h3 id="_3-1-\u4E3A\u4EC0\u4E48\u9700\u8981-jmm" tabindex="-1"><a class="header-anchor" href="#_3-1-\u4E3A\u4EC0\u4E48\u9700\u8981-jmm" aria-hidden="true">#</a> 3.1 \u4E3A\u4EC0\u4E48\u9700\u8981 <code>JMM</code></h3><p><code>C</code> \u8BED\u8A00\u4E0D\u5B58\u5728\u5185\u5B58\u6A21\u578B\u7684\u6982\u5FF5\uFF0C\u56E0\u6B64\uFF1A</p><ol><li><code>C</code> \u8BED\u8A00\u4F9D\u8D56\u5904\u7406\u5668\uFF0C\u4E0D\u540C\u5904\u7406\u5668\u7ED3\u679C\u4E0D\u4E00\u6837</li><li><code>C</code> \u8BED\u8A00\u65E0\u6CD5\u4FDD\u8BC1\u5E76\u53D1\u5B89\u5168</li></ol><p><code>Java</code> \u7A0B\u5E8F\u8BBE\u8BA1\u4E2D\uFF0C\u9700\u8981\u4E00\u4E2A\u6807\u51C6\uFF0C\u8BA9\u591A\u7EBF\u7A0B\u8FD0\u884C\u7684\u7ED3\u679C\u53EF\u9884\u671F\u3002</p><h3 id="_3-2-jmm-\u662F\u4E00\u79CD\u89C4\u8303" tabindex="-1"><a class="header-anchor" href="#_3-2-jmm-\u662F\u4E00\u79CD\u89C4\u8303" aria-hidden="true">#</a> 3.2 <code>JMM</code> \u662F\u4E00\u79CD\u89C4\u8303</h3><p><code>JMM</code> \u662F\u4E00\u7EC4\u89C4\u8303\uFF0C\u9700\u8981\u5404\u4E2A <code>JVM</code> \u7684\u5B9E\u73B0\u6765\u9075\u5FAA <code>JMM</code> \u89C4\u8303\uFF0C\u4EE5\u4FBF\u4E8E\u5F00\u53D1\u8005\u53EF\u4EE5\u5229\u7528\u8FD9\u4E9B\u89C4\u8303\uFF0C\u66F4\u65B9\u4FBF\u5730\u5F00\u53D1\u591A\u7EBF\u7A0B\u7A0B\u5E8F\u3002</p><p>\u5982\u679C\u6CA1\u6709\u8FD9\u6837\u7684\u4E00\u4E2A <code>JMM</code> \u5185\u5B58\u6A21\u578B\u6765\u89C4\u8303\uFF0C\u90A3\u4E48\u5F88\u53EF\u80FD\u7ECF\u8FC7\u4E86\u4E0D\u540C <code>JVM</code> \u7684\u4E0D\u540C\u89C4\u5219\u7684\u91CD\u6392\u5E8F\u4E4B\u540E\uFF0C\u5BFC\u81F4\u4E0D\u540C\u7684\u865A\u62DF\u673A\u4E0A\u8FD0\u884C\u7684\u7ED3\u679C\u4E0D\u4E00\u6837\uFF0C\u90A3\u662F\u5F88\u5927\u7684\u95EE\u9898\u3002</p><h3 id="_3-3-jmm-\u662F\u5DE5\u5177\u7C7B\u548C\u5173\u952E\u5B57\u7684\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#_3-3-jmm-\u662F\u5DE5\u5177\u7C7B\u548C\u5173\u952E\u5B57\u7684\u539F\u7406" aria-hidden="true">#</a> 3.3 <code>JMM</code> \u662F\u5DE5\u5177\u7C7B\u548C\u5173\u952E\u5B57\u7684\u539F\u7406</h3><p><code>volatile</code>\u3001<code>synchronized</code>\u3001<code>Lock</code> \u7B49\u7684\u539F\u7406\u90FD\u662F <code>JMM</code>\u3002</p><p>\u5982\u679C\u6CA1\u6709 <code>JMM</code>\uFF0C\u90A3\u5C31\u9700\u8981\u6211\u4EEC\u81EA\u5DF1\u6307\u5B9A\u4EC0\u4E48\u65F6\u5019\u7528\u5185\u5B58\u6805\u680F\u7B49\uFF0C\u90A3\u662F\u76F8\u5F53\u9EBB\u70E6\u7684\u3002\u5E78\u597D\u6709\u4E86 <code>JMM</code>\uFF0C\u8BA9\u6211\u4EEC\u53EA\u9700\u8981\u7528\u540C\u6B65\u5DE5\u5177\u548C\u5173\u952E\u5B57\u5C31\u53EF\u4EE5\u5F00\u53D1\u5E76\u53D1\u7A0B\u5E8F\u3002</p><h3 id="_3-4-jmm-\u7684\u4E09\u4E2A\u91CD\u8981\u5185\u5BB9-\u91CD\u6392\u5E8F\u3001\u53EF\u89C1\u6027\u3001\u539F\u5B50\u6027" tabindex="-1"><a class="header-anchor" href="#_3-4-jmm-\u7684\u4E09\u4E2A\u91CD\u8981\u5185\u5BB9-\u91CD\u6392\u5E8F\u3001\u53EF\u89C1\u6027\u3001\u539F\u5B50\u6027" aria-hidden="true">#</a> 3.4 <code>JMM</code> \u7684\u4E09\u4E2A\u91CD\u8981\u5185\u5BB9\uFF08\u91CD\u6392\u5E8F\u3001\u53EF\u89C1\u6027\u3001\u539F\u5B50\u6027\uFF09</h3><p><code>JMM</code> \u7684\u4E09\u4E2A\u91CD\u8981\u5185\u5BB9\u662F\uFF1A</p><ol><li>\u91CD\u6392\u5E8F</li><li>\u53EF\u89C1\u6027</li><li>\u539F\u5B50\u6027</li></ol><h2 id="_4-\u91CD\u6392\u5E8F" tabindex="-1"><a class="header-anchor" href="#_4-\u91CD\u6392\u5E8F" aria-hidden="true">#</a> 4. \u91CD\u6392\u5E8F</h2><h3 id="_4-1-\u4EC0\u4E48\u662F\u91CD\u6392\u5E8F" tabindex="-1"><a class="header-anchor" href="#_4-1-\u4EC0\u4E48\u662F\u91CD\u6392\u5E8F" aria-hidden="true">#</a> 4.1 \u4EC0\u4E48\u662F\u91CD\u6392\u5E8F</h3><p><img src="'+g+'" alt="" loading="lazy"></p><p><img src="'+u+`" alt="" loading="lazy"></p><p>\u5982\u4E0A\u4EE3\u7801\u4E2D\uFF0C\u6F14\u793A\u4E86\u91CD\u6392\u5E8F\u7684\u73B0\u8C61\uFF0C\u5206\u6790\u5982\u4E0B\uFF1A</p><div class="language-text ext-text"><pre class="language-text"><code>\u4E0D\u8003\u8651\u91CD\u6392\u5E8F\uFF0Cx \u548C y \u7684\u6267\u884C\u7ED3\u679C\u53EA\u6709\u4E09\u79CD\u60C5\u51B5\uFF1A
1. \u7EBF\u7A0B one \u4E2D\u7684 a=1; x=b \u5148\u6267\u884C\u5B8C\u6BD5\uFF0C\u518D\u6267\u884C\u7EBF\u7A0B two \u4E2D\u7684 b=1; y=a
    \u6B64\u65F6\uFF0C\u7531\u4E8E\u7EBF\u7A0B one \u4E2D\u7ED9 x \u8D4B\u503C\u7684\u65F6\u5019\u7EBF\u7A0B two \u4E2D\u8FD8\u672A\u7ED9 b \u8D4B\u503C\uFF0C\u6240\u4EE5 x=0, y=1
2. \u7EBF\u7A0B two \u4E2D\u7684 b=1; y=a \u5148\u6267\u884C\u5B8C\u6BD5\uFF0C\u518D\u6267\u884C\u7EBF\u7A0B one \u4E2D\u7684 a=1; x=b
    \u6B64\u65F6\uFF0C\u7531\u4E8E\u7EBF\u7A0B two \u4E2D\u7ED9 y \u8D4B\u503C\u7684\u65F6\u5019\u7EBF\u7A0B one \u4E2D\u8FD8\u672A\u7ED9 a \u8D4B\u503C\uFF0C\u6240\u4EE5 x=1, y=0
3. \u7EBF\u7A0B one \u4E2D\u7684 a=1 \u5148\u6267\u884C\uFF0C\u518D\u6267\u884C\u7EBF\u7A0B two \u4E2D\u7684 b=1\uFF0C\u63A5\u7740\u518D\u6267\u884C\u7EBF\u7A0B one \u4E2D\u7684 x=b\uFF0C\u6700\u540E\u518D\u6267\u884C\u7EBF\u7A0B two \u4E2D\u7684 y=a\uFF0C\u6B64\u65F6\uFF0Cx=1, y=1

\u4E5F\u5C31\u662F\u8BF4\uFF0C\u4E0D\u8003\u8651\u91CD\u6392\u5E8F\u7684\u60C5\u51B5\uFF0C\u662F\u4E0D\u4F1A\u51FA\u73B0 x=0, y=0 \u7684\u60C5\u51B5\u7684\u3002
\u4F46\u662F\uFF0C\u6267\u884C\u7A0B\u5E8F\uFF0C\u53EF\u4EE5\u53D1\u73B0\uFF0C\u7ECF\u8FC7\u82E5\u5E72\u6B21\u7684 for \u5FAA\u73AF\u540E\uFF0C\u4F1A\u51FA\u73B0 x=0, y=0 \u7684\u60C5\u51B5\uFF0C
\u8FD9\u662F\u56E0\u4E3A\u7EBF\u7A0B one \u6216/\u548C \u7EBF\u7A0B two \u53D1\u751F\u4E86\u91CD\u6392\u5E8F\u3002\u8003\u8651\u5982\u4E0B 2 \u4E2A\u7EBF\u7A0B\u90FD\u53D1\u9001\u91CD\u6392\u5E8F\u7684\u60C5\u51B5\uFF1A
1. \u7EBF\u7A0B one \u4E2D\u7684 a=1; x=b \u91CD\u6392\u5E8F\u540E\u7684\u6267\u884C\u987A\u5E8F\u53D8\u6210\u4E86 x=b; a=1
2. \u7EBF\u7A0B two \u4E2D\u7684 b=1; y=a \u91CD\u6392\u5E8F\u540E\u7684\u6267\u884C\u987A\u5E8F\u53D8\u6210\u4E86 y=a; b=1
\u4E8E\u662F\uFF0C\u5F53\u7EBF\u7A0B one \u4E2D\u7684 x=b \u5148\u6267\u884C\uFF0C\u518D\u6267\u884C\u7EBF\u7A0B two \u4E2D\u7684 y=a \u65F6\uFF0C\u5C31\u4F1A\u51FA\u73B0 x=0, y=0 \u7684\u60C5\u51B5\u3002
\uFF08\u5F53\u7136\uFF0C\u7EBF\u7A0B one \u6216\u7EBF\u7A0B two \u4E2D\u7684\u4EC5\u4EC5\u67D0\u4E00\u4E2A\u7EBF\u7A0B\u53D1\u751F\u91CD\u6392\u5E8F\uFF0C\u4E5F\u53EF\u80FD\u4F1A\u51FA\u73B0 x=0, y=0 \u7684\u60C5\u51B5\uFF09
</code></pre></div><p>\u5206\u6790\u5B8C\u4E0A\u9762\u7684\u4EE3\u7801\u540E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5BF9\u91CD\u6392\u5E8F\u8FDB\u884C\u5982\u4E0B\u5B9A\u4E49\uFF1A</p><div class="language-text ext-text"><pre class="language-text"><code>\u4EC0\u4E48\u662F\u91CD\u6392\u5E8F\uFF1F
    \u5728\u7EBF\u7A0B 1 \u5185\u90E8\u7684\u4E24\u884C\u4EE3\u7801\u7684\u5B9E\u9645\u6267\u884C\u987A\u5E8F\u548C\u4EE3\u7801\u5728 Java \u6587\u4EF6\u4E2D\u7684\u987A\u5E8F\u4E0D\u4E00\u6837\uFF0C\u4EE3\u7801\u6307\u4EE4\u5E76\u4E0D\u662F\u4E25\u683C\u6309\u7167\u4EE3\u7801\u8BED\u53E5\u987A\u5E8F\u6267\u884C\u7684\uFF0C
    \u5B83\u4EEC\u7684\u987A\u5E8F\u88AB\u6539\u53D8\u4E86\uFF0C\u8FD9\u5C31\u662F\u91CD\u6392\u5E8F\u3002
    \u5982\u4E0A\u4EE3\u7801\u4E2D\uFF0C\u88AB\u98A0\u5012\u7684\u53EF\u80FD\u662F y=a \u548C b=1 \u8FD9\u4E24\u884C\u8BED\u53E5\u3002
</code></pre></div><h3 id="_4-2-\u91CD\u6392\u5E8F\u7684\u597D\u5904-\u63D0\u9AD8\u5904\u7406\u901F\u5EA6" tabindex="-1"><a class="header-anchor" href="#_4-2-\u91CD\u6392\u5E8F\u7684\u597D\u5904-\u63D0\u9AD8\u5904\u7406\u901F\u5EA6" aria-hidden="true">#</a> 4.2 \u91CD\u6392\u5E8F\u7684\u597D\u5904\uFF08\u63D0\u9AD8\u5904\u7406\u901F\u5EA6\uFF09</h3><p><img src="`+b+'" alt="" loading="lazy"></p><p>\u5982\u4E0A\u56FE\u6240\u793A\uFF0C\u5BF9\u6BD4\u91CD\u6392\u5E8F\u524D\u540E\u7684\u6307\u4EE4\u4F18\u5316\uFF0C\u91CD\u6392\u5E8F\u660E\u663E\u63D0\u9AD8\u4E86\u5904\u7406\u901F\u5EA6\u3002</p><h3 id="_4-3-\u91CD\u6392\u5E8F\u7684-3-\u79CD\u60C5\u51B5" tabindex="-1"><a class="header-anchor" href="#_4-3-\u91CD\u6392\u5E8F\u7684-3-\u79CD\u60C5\u51B5" aria-hidden="true">#</a> 4.3 \u91CD\u6392\u5E8F\u7684 <code>3</code> \u79CD\u60C5\u51B5</h3><p>\u5982\u4E0B\u4E09\u79CD\u60C5\u51B5\u4E0B\uFF0C\u90FD\u53EF\u4EE5\u53D1\u751F\u91CD\u6392\u5E8F\uFF1A</p><ol><li>\u7F16\u8BD1\u5668\u4F18\u5316\uFF1A\u5305\u62EC <code>JVM</code>\uFF0C<code>JIT</code> \u7F16\u8BD1\u5668\u7B49</li><li><code>CPU</code> \u6307\u4EE4\u91CD\u6392\uFF1A\u5C31\u7B97\u7F16\u8BD1\u5668\u4E0D\u53D1\u751F\u91CD\u6392\uFF0C<code>CPU</code> \u4E5F\u53EF\u80FD\u5BF9\u6307\u4EE4\u8FDB\u884C\u91CD\u6392</li><li>\u5185\u5B58\u7684 \u201C\u91CD\u6392\u5E8F\u201D\uFF1A\u7EBF\u7A0B <code>A</code> \u7684\u4FEE\u6539\u7EBF\u7A0B <code>B</code> \u5374\u770B\u4E0D\u5230\uFF0C\u4ECE\u800C\u5F15\u51FA <strong>\u53EF\u89C1\u6027\u95EE\u9898</strong></li></ol><h2 id="_5-\u53EF\u89C1\u6027" tabindex="-1"><a class="header-anchor" href="#_5-\u53EF\u89C1\u6027" aria-hidden="true">#</a> 5. \u53EF\u89C1\u6027</h2><h3 id="_5-1-\u4EC0\u4E48\u662F\u53EF\u89C1\u6027\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_5-1-\u4EC0\u4E48\u662F\u53EF\u89C1\u6027\u95EE\u9898" aria-hidden="true">#</a> 5.1 \u4EC0\u4E48\u662F\u53EF\u89C1\u6027\u95EE\u9898</h3><p><img src="'+v+'" alt="" loading="lazy"></p><p>\u5982\u4E0A\u4EE3\u7801\u6240\u793A\uFF0C\u5206\u6790\u5982\u4E0B\u4E09\u79CD\u60C5\u51B5\uFF1A</p><p><img src="'+m+`" alt="" loading="lazy"></p><div class="language-text ext-text"><pre class="language-text"><code>1. \u5F53\u8BFB\u7EBF\u7A0B readThread \u5148\u5168\u90E8\u6267\u884C\u5B8C\u6BD5\u65F6\uFF0C\u5C31\u4F1A\u6253\u5370 b=2; a=1
2. \u5F53\u5199\u7EBF\u7A0B writeThread \u5148\u5168\u90E8\u6267\u884C\u5B8C\u6BD5\u540E\uFF0C\u518D\u6267\u884C\u8BFB\u7EBF\u7A0B readThread\uFF0C\u5C31\u4F1A\u6253\u5370 b=3; a=3
3. \u5F53\u5199\u7EBF\u7A0B writeThread \u5148\u6267\u884C\u5230 a=3\uFF0C\u7136\u540E\u5207\u6362\u5230\u8BFB\u7EBF\u7A0B readThread \u6267\u884C\uFF0C\u6B64\u65F6\uFF0C\u8BFB\u7EBF\u7A0B readThread \u5C31\u4F1A\u6253\u5370 b=2; a=3
</code></pre></div><p><strong>\u7279\u522B\u5730\uFF0C\u5F53\u51FA\u73B0\u53EF\u89C1\u6027\u95EE\u9898\u65F6\uFF0C\u5C31\u4F1A\u51FA\u73B0 <code>b=3; a=1</code> \u7684\u60C5\u51B5\uFF1A</strong></p><p><img src="`+x+`" alt="" loading="lazy"></p><div class="language-text ext-text"><pre class="language-text"><code>\u4EC0\u4E48\u662F\u53EF\u89C1\u6027\u95EE\u9898\uFF1F
    \u5982\u4E0A\u8F93\u51FA\u7ED3\u679C\uFF0C\u5C31\u662F\u5199\u7EBF\u7A0B writeThread \u4E2D\u867D\u7136\u5DF2\u7ECF\u6267\u884C\u4E86 a=3; b=a\uFF0C
    \u4F46\u662F\uFF0C\u8BFB\u7EBF\u7A0B readThread \u4E2D\u5374\u65E0\u6CD5\u53D1\u73B0\u53D8\u91CF a, b \u4E2D\u7684\u503C\u88AB\u4FEE\u6539\u4E86\uFF0C\u6216\u8005\u53EA\u53D1\u73B0\u5176\u4E2D\u67D0\u4E2A\u53D8\u91CF\u7684\u503C\u88AB\u4FEE\u6539\u4E86\u3002

\u4E3A\u4EC0\u4E48\u4F1A\u53D1\u751F\u53EF\u89C1\u6027\u95EE\u9898\uFF1F
    \u4E4B\u6240\u4EE5\u51FA\u73B0\u53EF\u89C1\u6027\u95EE\u9898\uFF0C\u662F\u7531\u4E8E\u4E3B\u5185\u5B58\u548C\u5DE5\u4F5C\u5185\u5B58\uFF08\u4E5F\u79F0\u672C\u5730\u5185\u5B58\uFF09\u7684\u5B58\u5728\u5F15\u8D77\u7684\u3002
    \u4E3B\u5185\u5B58\u662F\u591A\u7EBF\u7A0B\u5171\u4EAB\u7684\uFF0C\u5DE5\u4F5C\u5185\u5B58\u662F\u7EBF\u7A0B\u79C1\u6709\u7684\u3002
    \u591A\u7EBF\u7A0B\u8BBF\u95EE\u7684\u5171\u4EAB\u53D8\u91CF\u53EF\u4EE5\u8BA4\u4E3A\u662F\u4FDD\u5B58\u5728\u4E3B\u5185\u5B58\u4E2D\u7684\uFF0C
    \u4F46\u662F\u7EBF\u7A0B\u4E2D\u64CD\u4F5C\u7684\u5171\u4EAB\u53D8\u91CF\uFF0C\u5374\u4E0D\u662F\u4E3B\u5185\u5B58\u4E2D\u7684\u5171\u4EAB\u53D8\u91CF\uFF0C\u800C\u662F\u4E3B\u5185\u5B58\u7684\u5171\u4EAB\u53D8\u91CF\u7684\u526F\u672C\u62F7\u8D1D\u3002
    \u5373\u7EBF\u7A0B\u4F1A\u628A\u5171\u4EAB\u53D8\u91CF\u62F7\u8D1D\u5230\u81EA\u5DF1\u7684\u5DE5\u4F5C\u5185\u5B58\u4E2D\uFF0C\u64CD\u4F5C\u7ED3\u675F\u540E\uFF0C\u518D\u628A\u4FEE\u6539\u4E86\u7684\u5171\u4EAB\u53D8\u91CF\u8FD4\u56DE\u7ED9\u4E3B\u5185\u5B58\u3002
    \u4E8E\u662F\uFF0C\u5C31\u4F1A\u51FA\u73B0\u8FD9\u6837\u4E00\u4E2A\u95EE\u9898\uFF1A
    \u5F53\u5199\u7EBF\u7A0B writeThread \u4FEE\u6539\u4E86\u5DE5\u4F5C\u5185\u5B58\u4E2D\u7684\u53D8\u91CF a \u548C b\uFF0C\u4E14\u628A\u53D8\u91CF b \u8FD4\u56DE\u7ED9\u4E86\u4E3B\u5185\u5B58\uFF08\u8FD8\u6CA1\u6709\u5C06\u53D8\u91CF a \u8FD4\u56DE\u7ED9\u4E3B\u5185\u5B58\uFF09\uFF0C
    \u6B64\u65F6\uFF0C\u5207\u6362\u5230\u8BFB\u7EBF\u7A0B readThread\uFF0C\u4E8E\u662F\uFF0C\u8BFB\u7EBF\u7A0B readThread \u4ECE\u4E3B\u5185\u5B58\u4E2D\u8BBF\u95EE\u5230\u7684\u53D8\u91CF b=3\uFF0C\u4F46\u53D8\u91CF a \u4ECD\u7136\u662F 1
</code></pre></div><h4 id="\u7528-volatile-\u89E3\u51B3\u53EF\u89C1\u6027\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u7528-volatile-\u89E3\u51B3\u53EF\u89C1\u6027\u95EE\u9898" aria-hidden="true">#</a> \u7528 <code>volatile</code> \u89E3\u51B3\u53EF\u89C1\u6027\u95EE\u9898</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FieldVisibility</span> <span class="token punctuation">{</span>
    <span class="token comment">// int x = 0; // \u672A\u4F7F\u7528 volatile \u65F6</span>
    <span class="token keyword">volatile</span> <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">writeThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// \u5047\u8BBE\u5728\u5199\u7EBF\u7A0B\u4E2D\u6267\u884C</span>
        x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">readThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// \u5047\u8BBE\u5728\u8BFB\u7EBF\u7A0B\u4E2D\u6267\u884C</span>
        <span class="token keyword">int</span> r2 <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>\u672A\u4F7F\u7528 <code>volatile</code> \u65F6</strong></p><p><img src="`+f+'" alt="" loading="lazy"></p><p><strong>\u4F7F\u7528 <code>volatile</code> \u65F6</strong></p><p><img src="'+_+'" alt="" loading="lazy"></p><h3 id="_5-2-\u4E3A\u4EC0\u4E48\u4F1A\u6709\u53EF\u89C1\u6027\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_5-2-\u4E3A\u4EC0\u4E48\u4F1A\u6709\u53EF\u89C1\u6027\u95EE\u9898" aria-hidden="true">#</a> 5.2 \u4E3A\u4EC0\u4E48\u4F1A\u6709\u53EF\u89C1\u6027\u95EE\u9898</h3><p><img src="'+k+'" alt="" loading="lazy"></p><p>\u51FA\u73B0\u53EF\u89C1\u6027\u95EE\u9898\u7684\u6839\u672C\u539F\u56E0\u5C31\u662F <strong><code>CPU</code> \u6709\u591A\u7EA7\u7F13\u5B58\uFF0C\u5BFC\u81F4\u8BFB\u7684\u6570\u636E\u8FC7\u671F</strong>\uFF0C\u5177\u4F53\u4E3A\uFF1A</p><ol><li>\u9AD8\u901F\u7F13\u5B58\u7684\u5BB9\u91CF\u6BD4\u4E3B\u5185\u5B58\u5C0F\uFF0C\u4F46\u662F\u901F\u5EA6\u4EC5\u6B21\u4E8E\u5BC4\u5B58\u5668\uFF0C\u6240\u4EE5\u5728 <code>CPU</code> \u548C\u4E3B\u5185\u5B58\u4E4B\u95F4\u5C31\u591A\u4E86 <code>Cache</code> \u5C42\u3002</li><li>\u7EBF\u7A0B\u95F4\u7684\u5BF9\u4E8E\u5171\u4EAB\u53D8\u91CF\u7684\u53EF\u89C1\u6027\u95EE\u9898\u4E0D\u662F\u76F4\u63A5\u7531\u591A\u6838\u5F15\u8D77\u7684\uFF0C\u800C\u662F<strong>\u7531\u591A\u7F13\u5B58\u5F15\u8D77\u7684</strong>\u3002</li><li>\u5982\u679C\u6240\u6709\u7684\u6838\u5FC3\u90FD\u53EA\u7528\u4E00\u4E2A\u7F13\u5B58\uFF0C\u90A3\u4E48\u4E5F\u5C31\u4E0D\u5B58\u5728\u5185\u5B58\u53EF\u89C1\u6027\u95EE\u9898\u4E86\u3002</li><li>\u6BCF\u4E2A\u6838\u5FC3\u90FD\u4F1A\u5C06\u81EA\u5DF1\u9700\u8981\u7684\u6570\u636E\u8BFB\u5230\u72EC\u5360\u7F13\u5B58\u4E2D\uFF0C\u6570\u636E\u4FEE\u6539\u540E\u4E5F\u662F\u5199\u5165\u5230\u7F13\u5B58\u4E2D\uFF0C\u7136\u540E\u7B49\u5F85\u5237\u5165\u5230\u4E3B\u5185\u5B58\u4E2D\u3002\u6240\u4EE5\u4F1A\u5BFC\u81F4\u6709\u4E9B\u6838\u5FC3\u8BFB\u53D6\u7684\u503C\u662F\u4E00\u4E2A\u8FC7\u671F\u7684\u503C\u3002</li></ol><h3 id="_5-3-jmm-\u7684\u62BD\u8C61-\u4E3B\u5185\u5B58-\u672C\u5730\u5185\u5B58" tabindex="-1"><a class="header-anchor" href="#_5-3-jmm-\u7684\u62BD\u8C61-\u4E3B\u5185\u5B58-\u672C\u5730\u5185\u5B58" aria-hidden="true">#</a> 5.3 <code>JMM</code> \u7684\u62BD\u8C61\uFF1A\u4E3B\u5185\u5B58&amp;\u672C\u5730\u5185\u5B58</h3><h4 id="_5-3-1-\u4EC0\u4E48\u662F\u4E3B\u5185\u5B58\u548C\u672C\u5730\u5185\u5B58" tabindex="-1"><a class="header-anchor" href="#_5-3-1-\u4EC0\u4E48\u662F\u4E3B\u5185\u5B58\u548C\u672C\u5730\u5185\u5B58" aria-hidden="true">#</a> 5.3.1 \u4EC0\u4E48\u662F\u4E3B\u5185\u5B58\u548C\u672C\u5730\u5185\u5B58</h4><p><img src="'+y+`" alt="" loading="lazy"></p><p>\u5982\u4E0A\u5982\u7684\u5E95\u5C42\u7EC6\u8282\u4E2D\uFF1A</p><div class="language-text ext-text"><pre class="language-text"><code>core1\uFF0Ccore2\uFF0Ccore3\uFF0Ccore4 \u770B\u6210\u662F\u4E00\u4E2A\u4E2A\u7684\u7EBF\u7A0B\uFF08\u5373\u5C06\u6838\u5FC3\u7406\u89E3\u4E3A\u7EBF\u7A0B\uFF09
registers\uFF0CL1 cache\uFF0CL2 cache \u770B\u6210\u662F\u5DE5\u4F5C\u5185\u5B58
L3 cache\uFF0CRAM \u770B\u6210\u662F\u4E3B\u5185\u5B58
</code></pre></div><p><code>Java</code> \u4F5C\u4E3A\u9AD8\u7EA7\u8BED\u8A00\uFF0C\u5C4F\u853D\u4E86\u8FD9\u4E9B\u5E95\u5C42\u7EC6\u8282\uFF0C\u7528 <code>JMM</code> \u5B9A\u4E49\u4E86\u4E00\u5957\u8BFB\u5199\u5185\u5B58\u6570\u636E\u7684\u89C4\u8303\u3002\u867D\u7136\u6211\u4EEC\u4E0D\u518D\u9700\u8981\u5173\u7CFB\u4E00\u7EA7\u7F13\u5B58\u548C\u4E8C\u7EA7\u7F13\u5B58\u7684\u95EE\u9898\uFF0C\u4F46\u662F\uFF0C<code>JMM</code> \u62BD\u8C61\u4E86\u4E3B\u5185\u5B58\u548C\u672C\u5730\u5185\u5B58\u7684\u6982\u5FF5\u3002</p><p>\u8FD9\u91CC\u8BF4\u7684\u672C\u5730\u5185\u5B58\u5E76\u4E0D\u662F\u771F\u7684\u662F\u4E00\u5757\u7ED9\u6BCF\u4E2A\u7EBF\u7A0B\u5206\u914D\u7684\u5185\u5B58\uFF0C\u800C\u662F <code>JMM</code> \u7684\u4E00\u4E2A\u62BD\u8C61\uFF0C\u662F\u5BF9\u4E8E\u5BC4\u5B58\u5668\u3001\u4E00\u7EA7\u7F13\u5B58\u3001\u4E8C\u7EA7\u7F13\u5B58\u7B49\u7684\u62BD\u8C61\u3002</p><p><img src="`+E+`" alt="" loading="lazy"></p><h4 id="_5-3-2-\u4E3B\u5185\u5B58\u548C\u672C\u5730\u5185\u5B58\u7684\u5173\u7CFB-\u5BFC\u81F4\u53EF\u89C1\u6027\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_5-3-2-\u4E3B\u5185\u5B58\u548C\u672C\u5730\u5185\u5B58\u7684\u5173\u7CFB-\u5BFC\u81F4\u53EF\u89C1\u6027\u95EE\u9898" aria-hidden="true">#</a> 5.3.2 \u4E3B\u5185\u5B58\u548C\u672C\u5730\u5185\u5B58\u7684\u5173\u7CFB\uFF08\u5BFC\u81F4\u53EF\u89C1\u6027\u95EE\u9898\uFF09</h4><p><code>JMM</code> \u6709\u4EE5\u4E0B\u89C4\u5B9A\uFF1A</p><ol><li>\u6240\u6709\u7684\u53D8\u91CF\u90FD\u5B58\u50A8\u5728\u4E3B\u5185\u5B58\u4E2D\uFF0C\u540C\u65F6\u6BCF\u4E2A\u7EBF\u7A0B\u4E5F\u6709\u81EA\u5DF1\u72EC\u7ACB\u7684\u5DE5\u4F5C\u5185\u5B58\uFF0C\u5DE5\u4F5C\u5185\u5B58\u4E2D\u7684\u53D8\u91CF\u5185\u5BB9\u662F\u4E3B\u5185\u5B58\u4E2D\u7684\u62F7\u8D1D\uFF1B</li><li>\u7EBF\u7A0B\u4E0D\u80FD\u76F4\u63A5\u8BFB\u5199\u4E3B\u5185\u5B58\u4E2D\u7684\u53D8\u91CF\uFF0C\u800C\u662F\u53EA\u80FD\u64CD\u4F5C\u81EA\u5DF1\u5DE5\u4F5C\u5185\u5B58\u4E2D\u7684\u53D8\u91CF \uFF0C\u7136\u540E\u518D\u540C\u6B65\u5230\u4E3B\u5185\u5B58\u4E2D\uFF1B</li><li>\u4E3B\u5185\u5B58\u662F\u591A\u4E2A\u7EBF\u7A0B\u5171\u4EAB\u7684\uFF0C\u4F46\u7EBF\u7A0B\u95F4\u4E0D\u5171\u4EAB\u5DE5\u4F5C\u5185\u5B58\uFF0C\u5982\u679C\u7EBF\u7A0B\u95F4\u9700\u8981\u901A\u4FE1\uFF0C\u5FC5\u987B\u501F\u52A9\u4E3B\u5185\u5B58\u4E2D\u8F6C\u6765\u5B8C\u6210\u3002</li></ol><p>\u4E8E\u662F\uFF0C\u7531\u4E8E\u6240\u6709\u7684\u5171\u4EAB\u53D8\u91CF\u5B58\u5728\u4E8E\u4E3B\u5185\u5B58\u4E2D\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u6709\u81EA\u5DF1\u7684\u672C\u5730\u5185\u5B58\uFF0C\u4E14\u7EBF\u7A0B\u8BFB\u5199\u5171\u4EAB\u6570\u636E\u4E5F\u662F\u901A\u8FC7\u672C\u5730\u5185\u5B58\u4EA4\u4E92\u7684\uFF0C\u6240\u4EE5\u5C31\u5BFC\u81F4\u4E86\u53EF\u89C1\u6027\u95EE\u9898\u3002</p><h3 id="_5-4-happens-before-\u89C4\u5219-\u4FDD\u8BC1\u53EF\u89C1\u6027\u7684\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_5-4-happens-before-\u89C4\u5219-\u4FDD\u8BC1\u53EF\u89C1\u6027\u7684\u89C4\u5219" aria-hidden="true">#</a> 5.4 <code>Happens-Before</code> \u89C4\u5219\uFF08\u4FDD\u8BC1\u53EF\u89C1\u6027\u7684\u89C4\u5219\uFF09</h3><p><code>Happens-Before</code> \u89C4\u5219\u5C31\u662F\u4FDD\u8BC1\u53EF\u89C1\u6027\u7684\u89C4\u5219\u3002</p><blockquote><p>\u5373\uFF1A\u5982\u679C <code>A happens before B</code>\uFF08\u53EF\u8BB0\u4E3A <code>hb(A, B)</code>\uFF09\uFF0C\u90A3\u4E48 <code>A</code> \u5BF9\u4E3B\u5185\u5B58\u4E2D\u53D8\u91CF\u7684\u4FEE\u6539\uFF0C\u5BF9 <code>B</code> \u90FD\u53EF\u89C1\u3002</p></blockquote><p><code>Happens-Before</code> \u89C4\u5219\u5305\u62EC\uFF1A</p><ol><li>\u5355\u7EBF\u7A0B\u89C4\u5219</li><li>\u9501\u64CD\u4F5C\uFF08<code>synchronized</code> \u548C <code>Lock</code>\uFF09</li><li><code>volatile</code> \u53D8\u91CF</li><li>\u7EBF\u7A0B\u542F\u52A8</li><li>\u7EBF\u7A0B <code>join</code></li><li>\u4F20\u9012\u6027</li><li>\u4E2D\u65AD</li><li>\u6784\u9020\u65B9\u6CD5</li><li>\u5DE5\u5177\u7C7B\u7684 <code>Happens-Before</code> \u89C4\u5219</li></ol><h4 id="_5-4-1-\u5355\u7EBF\u7A0B\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_5-4-1-\u5355\u7EBF\u7A0B\u89C4\u5219" aria-hidden="true">#</a> 5.4.1 \u5355\u7EBF\u7A0B\u89C4\u5219</h4><div class="language-text ext-text"><pre class="language-text"><code>\u5355\u7EBF\u7A0B\u89C4\u5219\u6307\u660E\uFF1A\u5728\u540C\u4E00\u4E2A\u7EBF\u7A0B\u4E2D\uFF0C\u524D\u9762\u8BED\u53E5\u7684\u6267\u884C\u7ED3\u679C\u5BF9\u540E\u9762\u7684\u8BED\u53E5\u90FD\u53EF\u89C1\u3002
\u5373\u4F7F\u53D1\u751F\u91CD\u6392\u5E8F\uFF0C\u5355\u7EBF\u7A0B\u89C4\u5219\u4E5F\u4E0D\u4F1A\u6539\u53D8\u3002
</code></pre></div><p><img src="`+B+'" alt="" loading="lazy"></p><p><img src="'+M+'" alt="" loading="lazy"></p><h4 id="_5-4-2-\u9501\u64CD\u4F5C-synchronized-\u548C-lock" tabindex="-1"><a class="header-anchor" href="#_5-4-2-\u9501\u64CD\u4F5C-synchronized-\u548C-lock" aria-hidden="true">#</a> 5.4.2 \u9501\u64CD\u4F5C\uFF08<code>synchronized</code> \u548C <code>Lock</code>\uFF09</h4><p><img src="'+q+`" alt="" loading="lazy"></p><p>\u5982\u4E0A\u56FE\uFF1A</p><div class="language-text ext-text"><pre class="language-text"><code>\u5047\u8BBE\u7EBF\u7A0B A \u5148\u83B7\u53D6\u5230\u9501 M\uFF0C\u800C\u7EBF\u7A0B B \u5728\u7B49\u5F85\u9501 M\u3002
\u90A3\u4E48\u5F53\u7EBF\u7A0B A \u89E3\u9501\u540E\uFF0C\u7EBF\u7A0B B \u83B7\u53D6\u5230\u9501 M \u4E14\u7EE7\u7EED\u6267\u884C\u65F6\uFF0C
\u7EBF\u7A0B B \u52A0\u9501\u540E\u7684\u64CD\u4F5C\u4E2D\u6240\u8BBF\u95EE\u4E3B\u5185\u5B58\u7684\u53D8\u91CF x \u7684\u503C\uFF0C\u80AF\u5B9A\u662F\u7EBF\u7A0B A \u4FEE\u6539\u540E\u7684\u503C\u3002
\u5373\uFF0C\u6B64\u65F6\u7EBF\u7A0B A \u4FEE\u6539\u540E\u7684\u53D8\u91CF x \u7684\u503C\u5BF9\u83B7\u53D6\u5230\u9501\u540E\u7684\u7EBF\u7A0B B \u6765\u8BF4\u603B\u662F\u53EF\u89C1\u7684\u3002
</code></pre></div><h4 id="_5-4-3-volatile-\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#_5-4-3-volatile-\u53D8\u91CF" aria-hidden="true">#</a> 5.4.3 <code>volatile</code> \u53D8\u91CF</h4><div class="language-text ext-text"><pre class="language-text"><code>\u53EA\u8981\u7EBF\u7A0B A \u4E2D\u5DF2\u7ECF\u4FEE\u6539\u4E86\u4E3B\u5185\u5B58\u4E2D\u7684\u88AB volatile \u4FEE\u9970\u7684\u53D8\u91CF\uFF0C
\u90A3\u4E48\u7EBF\u7A0B B \u4E2D\u4ECE\u4E3B\u5185\u5B58\u4E2D\u62FF\u5230\u7684\u8FD9\u4E2A\u88AB volatile \u4FEE\u9970\u7684\u53D8\u91CF\u7684\u503C\u5C31\u4E00\u5B9A\u662F\u88AB\u7EBF\u7A0B A \u4FEE\u6539\u540E\u7684\u503C\uFF0C\u4E0D\u4F1A\u51FA\u73B0\u53EF\u89C1\u6027\u95EE\u9898\u3002
\u4E5F\u5C31\u662F\u8BF4\uFF0C\u4E00\u4E2A\u7EBF\u7A0B\u4E2D\u5BF9 volatile \u53D8\u91CF\u6240\u505A\u8FC7\u7684\u4FEE\u6539\uFF0C\u5728\u5176\u4ED6\u7EBF\u7A0B\u8BBF\u95EE\u8BE5 volatile \u53D8\u91CF\u65F6\uFF0C\u603B\u662F\u53EF\u89C1\u7684\uFF0C
\u4E0D\u4F1A\u7531\u4E8E\u4E3B\u5185\u5B58\u548C\u5DE5\u4F5C\u5185\u5B58\u4E4B\u95F4\u7684\u540C\u6B65\u4E0D\u53CA\u65F6\u800C\u5BFC\u81F4\u53EF\u89C1\u6027\u95EE\u9898\u3002
</code></pre></div><p><img src="`+z+`" alt="" loading="lazy"></p><h4 id="_5-4-4-\u7EBF\u7A0B\u542F\u52A8" tabindex="-1"><a class="header-anchor" href="#_5-4-4-\u7EBF\u7A0B\u542F\u52A8" aria-hidden="true">#</a> 5.4.4 \u7EBF\u7A0B\u542F\u52A8</h4><div class="language-text ext-text"><pre class="language-text"><code>\u5728\u7EBF\u7A0B A \u4E2D\u542F\u52A8\u7EBF\u7A0B B \u65F6\uFF0C\u5728\u7EBF\u7A0B A \u4E2D\u8C03\u7528\u7EBF\u7A0B B \u7684 start() \u65B9\u6CD5\u4E4B\u524D\u7684\u6240\u6709\u4FEE\u6539\uFF0C\u5728\u7EBF\u7A0B B \u8FD0\u884C\u65F6\u90FD\u662F\u53EF\u89C1\u7684\u3002
</code></pre></div><p><img src="`+j+`" alt="" loading="lazy"></p><h4 id="_5-4-5-\u7EBF\u7A0B-join" tabindex="-1"><a class="header-anchor" href="#_5-4-5-\u7EBF\u7A0B-join" aria-hidden="true">#</a> 5.4.5 \u7EBF\u7A0B <code>join</code></h4><div class="language-text ext-text"><pre class="language-text"><code>\u5728 Thread A \u4E2D\u6267\u884C threadB.join(); \u4F1A\u4FDD\u8BC1 Thread B \u5148\u6267\u884C\u5B8C\u6BD5\u540E\uFF0C\u518D\u7EE7\u7EED\u6267\u884C Thread A,
\u4E4B\u540E\uFF0C\u5728 Thread A \u4E2D\u6267\u884C statement 1; \u65F6\uFF0CThread B \u4E2D\u5BF9\u4E3B\u5185\u5B58\u4E2D\u53D8\u91CF\u7684\u4FEE\u6539\uFF0C\u5728 Thread A \u4E2D\u90FD\u662F\u53EF\u89C1\u7684\u3002
</code></pre></div><p><img src="`+w+`" alt="" loading="lazy"></p><h4 id="_5-4-6-\u4F20\u9012\u6027" tabindex="-1"><a class="header-anchor" href="#_5-4-6-\u4F20\u9012\u6027" aria-hidden="true">#</a> 5.4.6 \u4F20\u9012\u6027</h4><p>\u5982\u679C <code>hb(A, B)</code> \u800C\u4E14 <code>hb(B, C)</code>\uFF0C\u90A3\u4E48\u53EF\u4EE5\u63A8\u51FA <code>hb(A, C)</code>\u3002</p><div class="language-text ext-text"><pre class="language-text"><code>hb \u8868\u793A happens before\uFF0C
hb(A, B) \u8868\u793A A happens before B\uFF0C\u5373 A \u5BF9\u4E3B\u5185\u5B58\u4E2D\u53D8\u91CF\u7684\u4FEE\u6539\uFF0C\u5BF9 B \u90FD\u662F\u53EF\u89C1\u7684\u3002

\u4F20\u9012\u6027\u5C31\u662F\u6307\uFF1A
    \u5982\u679C A \u5BF9\u4E3B\u5185\u5B58\u4E2D\u53D8\u91CF\u7684\u4FEE\u6539\u5BF9 B \u90FD\u53EF\u89C1\uFF0C\u4E14 B \u5BF9\u4E3B\u5185\u5B58\u4E2D\u53D8\u91CF\u7684\u4FEE\u6539\u5BF9 C \u90FD\u53EF\u89C1\uFF0C
    \u90A3\u4E48 A \u5BF9\u4E3B\u5185\u5B58\u4E2D\u53D8\u91CF\u7684\u4FEE\u6539\u5BF9 C \u90FD\u53EF\u89C1\u3002
    \u5373\uFF1A\u5982\u679C hb(A, B) \u4E14 hb(B, C)\uFF0C\u90A3\u4E48 hb(A, C)\u3002
</code></pre></div><h4 id="_5-4-7-\u4E2D\u65AD" tabindex="-1"><a class="header-anchor" href="#_5-4-7-\u4E2D\u65AD" aria-hidden="true">#</a> 5.4.7 \u4E2D\u65AD</h4><div class="language-text ext-text"><pre class="language-text"><code>\u4E00\u4E2A\u7EBF\u7A0B\u88AB\u5176\u4ED6\u7EBF\u7A0B interrupt \u65F6\uFF0C\u90A3\u4E48\u68C0\u6D4B\u4E2D\u65AD\uFF08isInterrupted\uFF09\u6216\u8005\u629B\u51FA InterruptedException \u4E00\u5B9A\u80FD\u770B\u5230\u3002
</code></pre></div><h4 id="_5-4-8-\u6784\u9020\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_5-4-8-\u6784\u9020\u65B9\u6CD5" aria-hidden="true">#</a> 5.4.8 \u6784\u9020\u65B9\u6CD5</h4><div class="language-text ext-text"><pre class="language-text"><code>\u5BF9\u8C61\u6784\u9020\u65B9\u6CD5\u7684\u6700\u540E\u4E00\u884C\u6307\u4EE4 happens-before \u4E8E finalize() \u65B9\u6CD5\u7684\u7B2C\u4E00\u884C\u6307\u4EE4\u3002
</code></pre></div><h4 id="_5-4-9-\u5DE5\u5177\u7C7B\u7684-happens-before-\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_5-4-9-\u5DE5\u5177\u7C7B\u7684-happens-before-\u89C4\u5219" aria-hidden="true">#</a> 5.4.9 \u5DE5\u5177\u7C7B\u7684 <code>Happens-Before</code> \u89C4\u5219</h4><p>\u5305\u62EC\uFF1A</p><ol><li>\u7EBF\u7A0B\u5B89\u5168\u7684\u5BB9\u5668 <code>get</code> \u4E00\u5B9A\u80FD\u770B\u5230\u5728\u6B64\u4E4B\u524D\u7684 <code>put</code> \u7B49\u5B58\u5165\u52A8\u4F5C</li><li><code>CountDownLatch</code></li><li><code>Semaphore</code></li><li><code>Future</code></li><li>\u7EBF\u7A0B\u6C60</li><li><code>CyclicBarrier</code></li></ol><h4 id="_5-4-10-happens-before-\u6F14\u793A\u6848\u4F8B" tabindex="-1"><a class="header-anchor" href="#_5-4-10-happens-before-\u6F14\u793A\u6848\u4F8B" aria-hidden="true">#</a> 5.4.10 <code>happens-before</code> \u6F14\u793A\u6848\u4F8B</h4><p><img src="`+J+`" alt="" loading="lazy"></p><p>\u4EE5\u4E0A\u4EE3\u7801\u4E2D\uFF0C\u4F1A\u51FA\u73B0\u5982\u4E0B\u51E0\u79CD\u60C5\u51B5\uFF1A</p><div class="language-text ext-text"><pre class="language-text"><code>1. a=3, b=2
2. a=1, b=2
3. a=3, b=3

\u7279\u522B\u5730\uFF0C\u5F53\u6CA1\u6709\u7ED9 b \u52A0 volatile \u65F6\uFF0C\u8FD8\u6709\u53EF\u80FD\u51FA\u73B0\u7B2C 4 \u79CD\u60C5\u51B5\uFF1A
4. a=1, b=3

\u8FD9\u662F\u56E0\u4E3A a \u867D\u7136\u88AB\u4FEE\u6539\u6765\u4E86\uFF0C\u4F46\u662F\u5176\u4ED6\u7EBF\u7A0B\u4E0D\u53EF\u89C1 \uFF0C\u800C b \u6070\u597D\u5176\u4ED6\u7EBF\u7A0B\u53EF\u89C1\uFF0C\u4ECE\u800C\u9020\u6210 a=1, b=3\u3002
</code></pre></div><p>\u4EE5\u4E0A\u6848\u4F8B\u4E2D\u4F7F\u7528\u4E86 <code>happens-before</code> \u89C4\u5219\u4E2D\u7684 <code>volatile</code> \u53D8\u91CF\u89C4\u5219\u907F\u514D\u4E86\u7531\u4E8E\u53EF\u89C1\u6027\u95EE\u9898\u800C\u5BFC\u81F4\u7684 <code>a=1, b=3</code> \u7684\u7ED3\u679C:</p><div class="language-text ext-text"><pre class="language-text"><code>volatile \u53D8\u91CF\u89C4\u5219\uFF1A
    \u5982\u679C A \u662F\u5BF9 volatile \u53D8\u91CF\u7684\u5199\u64CD\u4F5C\uFF0CB \u662F\u5BF9\u540C\u4E00\u4E2A\u53D8\u91CF\u7684\u8BFB\u64CD\u4F5C\uFF0C\u90A3\u4E48 hb(A, B)\u3002
</code></pre></div><h5 id="volatile-\u5B9E\u73B0\u8F7B\u91CF\u7EA7\u540C\u6B65-\u8FD1\u6731\u8005\u8D64" tabindex="-1"><a class="header-anchor" href="#volatile-\u5B9E\u73B0\u8F7B\u91CF\u7EA7\u540C\u6B65-\u8FD1\u6731\u8005\u8D64" aria-hidden="true">#</a> <code>volatile</code> \u5B9E\u73B0\u8F7B\u91CF\u7EA7\u540C\u6B65\uFF08\u8FD1\u6731\u8005\u8D64\uFF09</h5><p>\u5982\u4E0A\u6F14\u793A\u6848\u4F8B\u4E2D\uFF0C\u7ED9 <code>b</code> \u52A0\u4E86 <code>volatile</code>\uFF0C\u4E0D\u4EC5 <code>b</code> \u88AB\u5F71\u54CD\u4E86\uFF0C\u4E5F\u53EF\u4EE5\u5B9E\u73B0\u8F7B\u91CF\u7EA7\u540C\u6B65\uFF0C\u5373\uFF1A</p><div class="language-text ext-text"><pre class="language-text"><code>b \u4E4B\u524D\u7684\u5199\u5165\uFF08\u5373 b=a \u4E4B\u524D\u7684 a=3\uFF09\u5BF9\u8BFB\u53D6 b \u540E\u7684\u4EE3\u7801\uFF08\u5373 print b \u540E\u7684 print a\uFF09\u90FD\u53EF\u89C1\uFF0C
\u6240\u4EE5\u5728 writeThread \u91CC\u5BF9 a \u7684\u8D4B\u503C\uFF0C\u4E00\u5B9A\u4F1A\u5BF9 readThread \u91CC\u7684\u8BFB\u53D6\u53EF\u89C1\uFF0C\u6240\u4EE5\u8FD9\u91CC\u7684 a \u5373\u4F7F\u4E0D\u52A0 volatile\uFF0C
\u53EA\u8981 b \u8BFB\u5230\u7684\u662F 3\uFF0C\u5C31\u53EF\u4EE5\u7531 happens-before \u89C4\u5219\u4FDD\u8BC1\u8BFB\u53D6\u5230\u7684\u90FD\u662F 3\uFF0C\u800C\u4E0D\u53EF\u80FD\u8BFB\u53D6\u5230 1\u3002
</code></pre></div><blockquote><p>\u53EF\u4EE5\u7406\u89E3\u6210 <code>happens-before</code> \u89C4\u5219\u4E2D\u7684\u4F20\u9012\u6027\u89C4\u5219\u3002</p></blockquote><h3 id="_5-5-volatile-\u5173\u952E\u5B57" tabindex="-1"><a class="header-anchor" href="#_5-5-volatile-\u5173\u952E\u5B57" aria-hidden="true">#</a> 5.5 <code>volatile</code> \u5173\u952E\u5B57</h3><h4 id="_5-5-1-volatile-\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#_5-5-1-volatile-\u662F\u4EC0\u4E48" aria-hidden="true">#</a> 5.5.1 <code>volatile</code> \u662F\u4EC0\u4E48</h4><p><code>volatile</code> \u662F\u4E00\u79CD\u540C\u6B65\u673A\u5236\uFF0C\u6BD4 <code>synchronized</code> \u6216\u8005 <code>Lock</code> \u76F8\u5173\u7C7B\u66F4\u8F7B\u91CF\uFF0C\u56E0\u4E3A\u4F7F\u7528 <code>volatile</code> \u5E76\u4E0D\u4F1A\u53D1\u751F\u4E0A\u4E0B\u6587\u5207\u6362\u7B49\u5F00\u9500\u5F88\u5927\u7684\u884C\u4E3A\u3002</p><p>\u5982\u679C\u4E00\u4E2A\u53D8\u91CF\u88AB\u4FEE\u9970\u6210 <code>volatile</code>\uFF0C\u90A3\u4E48 <code>JVM</code> \u5C31\u77E5\u9053\u4E86\u8FD9\u4E2A\u53D8\u91CF\u53EF\u80FD\u4F1A\u88AB\u5E76\u53D1\u4FEE\u6539\u3002</p><p><code>volatile</code> \u7684\u5F00\u9500\u5C0F\u4E5F\u5C31\u610F\u5473\u7740\u4E86\u76F8\u5E94\u7684\u80FD\u529B\u4E5F\u5C0F\uFF0C\u867D\u7136\u8BF4 <code>volatile</code> \u662F\u7528\u6765\u540C\u6B65\u7684\uFF0C\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\u7684\uFF0C\u4F46\u662F <code>volatile</code> \u505A\u4E0D\u5230 <code>synchronized</code> \u90A3\u6837\u7684<strong>\u539F\u5B50\u4FDD\u62A4</strong>\uFF0C<code>volatile</code> \u4EC5\u5728\u5F88\u6709\u9650\u7684\u573A\u666F\u4E0B\u624D\u80FD\u53D1\u6325\u4F5C\u7528\u3002</p><h4 id="_5-5-2-volatile-\u7684\u9002\u7528\u573A\u5408" tabindex="-1"><a class="header-anchor" href="#_5-5-2-volatile-\u7684\u9002\u7528\u573A\u5408" aria-hidden="true">#</a> 5.5.2 <code>volatile</code> \u7684\u9002\u7528\u573A\u5408</h4><p><code>volatile</code> \u5173\u952E\u5B57\u5C31\u662F\u8BA9\u5199\u7EBF\u7A0B\u4E2D\u5BF9\u88AB <code>volatile</code> \u4FEE\u9970\u7684\u53D8\u91CF\u6240\u505A\u7684\u4FEE\u6539\u5B9E\u65F6\u5730\u5237\u65B0\u5230\u4E3B\u5185\u5B58\u4E2D\uFF0C\u8BA9\u8BFB\u7EBF\u7A0B\u8BBF\u95EE\u88AB <code>volatile</code> \u4FEE\u9970\u7684\u53D8\u91CF\u65F6\uFF0C\u76F4\u63A5\u4ECE\u4E3B\u5185\u5B58\u4E2D\u8BFB\u53D6\u3002</p><p><code>volatile</code> \u5173\u952E\u5B57\u53EF\u4EE5<strong>\u4FDD\u8BC1\u539F\u5B50\u64CD\u4F5C\u7684\u7EBF\u7A0B\u5B89\u5168</strong>\uFF08\u5373\u8BA9\u539F\u5B50\u64CD\u4F5C\u7684\u7ED3\u679C\u5BF9\u5176\u4ED6\u7EBF\u7A0B\u53EF\u89C1\uFF09\u3002\u4F46\u662F\u65E0\u6CD5\u4FDD\u8BC1\u975E\u539F\u5B50\u64CD\u4F5C\u7684\u7EBF\u7A0B\u5B89\u5168\uFF08\u5373\u65E0\u6CD5\u907F\u514D\u7EC4\u6210\u975E\u539F\u5B50\u64CD\u4F5C\u7684\u5404\u4E2A\u539F\u5B50\u64CD\u4F5C\u4E4B\u95F4\u7684\u7EBF\u7A0B\u5207\u6362\u5F15\u8D77\u7684\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\uFF09\u3002</p><div class="language-text ext-text"><pre class="language-text"><code>\u5982 a++ \u662F\u975E\u539F\u5B50\u64CD\u4F5C\uFF0C\u53EF\u5206\u89E3\u4E3A tmp=a+1 \u548C a=tmp \u4E24\u4E2A\u539F\u5B50\u64CD\u4F5C\u3002\u5982\u679C\u5728\u8FD9\u4E24\u4E2A\u539F\u5B50\u64CD\u4F5C\u4E4B\u95F4\u51FA\u73B0\u4E86\u7EBF\u7A0B\u5207\u6362\uFF0C\u90A3\u4E48\u5C31\u4F1A\u51FA\u73B0\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002
\u56E0\u6B64\uFF0C\u5F53\u7528 volatile \u4FEE\u9970\u53D8\u91CF a \u65F6\uFF0C\u53EA\u80FD\u4FDD\u8BC1 a=tmp \u8D4B\u503C\u540E\u5B9E\u65F6\u5730\u5237\u65B0\u5230\u4E3B\u5185\u5B58\uFF0C
\u4F46\u65E0\u6CD5\u907F\u514D tmp=a+1 \u548C a=tmp \u8FD9\u4E24\u4E2A\u539F\u5B50\u64CD\u4F5C\u4E4B\u95F4\u53EF\u80FD\u51FA\u73B0\u7684\u7EBF\u7A0B\u5207\u6362\u6240\u5F15\u8D77\u7684\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002

\u518D\u5982 flag=true \u662F\u539F\u5B50\u64CD\u4F5C\uFF0C\u5982\u679C flag \u88AB volatile \u4FEE\u9970\uFF0C\u90A3\u4E48\u53EF\u4EE5\u4FDD\u8BC1 flag=true \u8FD9\u6761\u539F\u5B50\u64CD\u4F5C\u8BED\u53E5\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\u3002

\u53C8\u5982 flag=!flag \u4E0D\u662F\u539F\u5B50\u64CD\u4F5C\uFF0C\u5047\u8BBE flag=false\uFF0C\u5219 flag=!flag \u53EF\u5206\u89E3\u4E3A tmp=!flag \u548C flag=tmp\uFF0C
\u56E0\u6B64\uFF0C\u5373\u4F7F flag \u88AB volatile \u4FEE\u9970\uFF0C\u4E5F\u6709\u53EF\u80FD\u56E0\u5728 tmp=!flag \u548C flag=tmp \u4E4B\u95F4\u51FA\u73B0\u7EBF\u7A0B\u5207\u6362\u5F15\u8D77\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002
</code></pre></div><p>\u7EFC\u4E0A\uFF1A</p><ol><li><code>volatile</code> <strong>\u4E0D\u9002\u7528\u4E8E\u591A\u7EBF\u7A0B\u4E0B\u7684\u975E\u539F\u5B50\u64CD\u4F5C</strong>\uFF08\u5982 <code>a++</code>\uFF0C<code>flag=!flag</code>\uFF09\u3002</li><li><code>volatile</code> <strong>\u53EF\u9002\u7528\u4E8E\u591A\u7EBF\u7A0B\u4E0B\u7684\u539F\u5B50\u64CD\u4F5C</strong>\uFF08\u5982 <code>flag=true</code>\uFF09\u3002</li></ol><p>\u53E6\u5916\uFF0C<code>volatile</code> \u8FD8\u53EF\u4EE5\u4F5C\u4E3A\u5237\u65B0\u4E4B\u524D\u53D8\u91CF\u7684\u89E6\u53D1\u5668\uFF1A</p><p><img src="`+V+`" alt="" loading="lazy"></p><p>\u5982\u4E0A\u4EE3\u7801\u6240\u793A\uFF1A</p><div class="language-text ext-text"><pre class="language-text"><code>\u7531 happens-before \u7684\u5355\u7EBF\u7A0B\u89C4\u5219\u53EF\u77E5\uFF0Chb(123, 4)
\u7531 happens-before \u7684 volatile \u53D8\u91CF\u7684\u89C4\u5219\u53EF\u77E5\uFF0Chb(4, 5)
\u4E8E\u662F\uFF0C\u7531 happens-before \u7684\u4F20\u9012\u6027\u89C4\u5219\u53EF\u63A8\u51FA\uFF0Chb(123, 5)

\u56E0\u6B64\uFF0C\u5982\u679C\u5728 Thread B \u4E2D\u8BFB\u53D6\u53D8\u91CF initialized \u4E3A true \u65F6\uFF0C
\u5C31\u8BF4\u660E\u4E86\u5728 Thread A \u4E2D\u7684\u524D\u4E09\u6761\u8BED\u53E5\u4E2D\u7684\u521D\u59CB\u5316\u4EE3\u7801\u90FD\u6267\u884C\u5B8C\u6BD5\uFF0C\u521D\u59CB\u5316\u7ED3\u679C\u5BF9 Thread B \u53EF\u89C1\u4E86\u3002
\u6240\u4EE5\uFF0C\u8FD9\u91CC\u5C31\u53EF\u4EE5\u5C06\u88AB volatile \u4FEE\u9970\u7684 initialized \u53D8\u91CF\u770B\u6210\u4E00\u4E2A\u89E6\u53D1\u5668\uFF0C
\u5373\u5F53 Thread B \u4E2D\u53D1\u73B0 initialized \u7684\u503C\u4E3A true \u65F6\uFF0C\u8868\u793A Thread A \u4E2D\u7684\u521D\u59CB\u5316\u7ED3\u679C\u53EF\u89C1\uFF0C
\u6B64\u65F6\u5C31\u53EF\u4EE5\u7ED3\u675F while \u5FAA\u73AF\uFF0C\u89E6\u53D1 Thread B \u4E2D\u7684 &quot;// use configOptions&quot; \u4E4B\u540E\u7684\u4EE3\u7801\u7EE7\u7EED\u6267\u884C\u3002
</code></pre></div><h4 id="_5-5-3-volatile-\u7684\u4F5C\u7528-\u907F\u514D\u53EF\u89C1\u6027\u95EE\u9898\u3001\u7981\u6B62\u91CD\u6392\u5E8F" tabindex="-1"><a class="header-anchor" href="#_5-5-3-volatile-\u7684\u4F5C\u7528-\u907F\u514D\u53EF\u89C1\u6027\u95EE\u9898\u3001\u7981\u6B62\u91CD\u6392\u5E8F" aria-hidden="true">#</a> 5.5.3 <code>volatile</code> \u7684\u4F5C\u7528\uFF08\u907F\u514D\u53EF\u89C1\u6027\u95EE\u9898\u3001\u7981\u6B62\u91CD\u6392\u5E8F\uFF09</h4><p><code>volatile</code> \u6709\u4E24\u70B9\u4F5C\u7528\uFF1A</p>`,119),R=e("li",null,[e("p",null,"\u907F\u514D\u53EF\u89C1\u6027\u95EE\u9898"),e("blockquote",null,[e("p",null,[a("\u8BFB\u53D6\u4E00\u4E2A "),e("code",null,"volatile"),a(" \u53D8\u91CF\u4E4B\u524D\uFF0C\u9700\u8981\u5148\u4F7F\u76F8\u5E94\u7684\u672C\u5730\u7F13\u5B58\u5931\u6548 \uFF0C\u8FD9\u6837\u5C31\u5FC5\u987B\u5230\u4E3B\u5185\u5B58\u8BFB\u53D6\u6700\u65B0\u503C\uFF0C\u5199\u4E00\u4E2A "),e("code",null,"volatile"),a(" \u5C5E\u6027\u4F1A\u7ACB\u5373\u5237\u5165\u5230\u4E3B\u5185\u5B58\u3002")])])],-1),D=e("p",null,"\u7981\u6B62\u6307\u4EE4\u91CD\u6392\u5E8F",-1),L=a("\u89E3\u51B3\u5355\u4F8B\u53CC\u91CD\u9501\u4E71\u5E8F\u95EE\u9898"),I=n(`<h4 id="_5-5-4-volatile-\u548C-synchronized-\u7684\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#_5-5-4-volatile-\u548C-synchronized-\u7684\u5173\u7CFB" aria-hidden="true">#</a> 5.5.4 <code>volatile</code> \u548C <code>synchronized</code> \u7684\u5173\u7CFB</h4><p><code>synchronized</code> \u5173\u952E\u5B57\u4E0D\u4F46\u80FD\u591F\u4FDD\u8BC1\u53EF\u89C1\u6027\uFF0C\u8FD8\u80FD\u591F\u5C06\u4E00\u7CFB\u5217\u7684\u975E\u539F\u5B50\u64CD\u4F5C\u5305\u88F9\u6210\u4E00\u4E2A\u539F\u5B50\u64CD\u4F5C\u3002</p><blockquote><p>\u5373\u4FDD\u8BC1\u5728\u8FD9\u4E00\u7CFB\u5217\u7684\u975E\u539F\u5B50\u64CD\u4F5C\u4E4B\u95F4\u4E0D\u53D1\u751F\u7EBF\u7A0B\u5207\u6362\uFF0C\u4ECE\u800C\u907F\u514D\u7EBF\u7A0B\u5207\u6362\u5F15\u8D77\u7684\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002</p></blockquote><p>\u800C <code>volatile</code> \u5173\u952E\u5B57\u53EA\u80FD\u591F\u4FDD\u8BC1\u53EF\u89C1\u6027\u3002</p><blockquote><p>\u5373\u53EA\u80FD\u591F\u907F\u514D\u56E0\u7EBF\u7A0B\u79C1\u6709\u7684\u5DE5\u4F5C\u5185\u5B58\u548C\u591A\u7EBF\u7A0B\u5171\u6709\u7684\u4E3B\u5185\u5B58\u4E4B\u95F4\u7684\u4E0D\u53CA\u65F6\u540C\u6B65\uFF0C\u800C\u5BFC\u81F4\u5176\u4ED6\u7EBF\u7A0B\u8BBF\u95EE\u4E3B\u5185\u5B58\u4E2D\u7684\u53D8\u91CF\u503C\u4E0D\u662F\u88AB\u7EBF\u7A0B\u4FEE\u6539\u540E\u7684\u53D8\u91CF\u503C\uFF0C\u6240\u5F15\u8D77\u7684\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002</p></blockquote><p>\u7B80\u800C\u8A00\u4E4B\uFF1A</p><ol><li><code>synchronized</code> \u5173\u952E\u5B57\u65E2\u53EF\u4EE5\u4FDD\u8BC1\u53EF\u89C1\u6027\uFF0C\u53C8\u53EF\u4EE5\u4FDD\u8BC1\u539F\u5B50\u6027\uFF1B</li><li><code>volatile</code> \u5173\u952E\u5B57\u53EA\u80FD\u591F\u4FDD\u8BC1\u53EF\u89C1\u6027\u3002</li></ol><p>\u5982\u4E0B\u60C5\u51B5\u4E2D\uFF0C<code>volatile</code> \u53EF\u4EE5\u770B\u505A\u662F\u8F7B\u91CF\u7248\u7684 <code>synchronized</code>\uFF1A</p><div class="language-text ext-text"><pre class="language-text"><code>\u5982\u679C\u4E00\u4E2A\u5171\u4EAB\u53D8\u91CF\u81EA\u59CB\u81F3\u7EC8\u53EA\u88AB\u5404\u4E2A\u7EBF\u7A0B\u8D4B\u503C\uFF0C\u800C\u6CA1\u6709\u5176\u4ED6\u7684\u64CD\u4F5C\uFF0C
\u90A3\u4E48\u5C31\u53EF\u4EE5\u7528 volatile \u6765\u4EE3\u66FF synchronized \u6216\u8005\u4EE3\u66FF\u539F\u5B50\u53D8\u91CF\u3002
\u56E0\u4E3A\u8D4B\u503C\u81EA\u8EAB\u662F\u5177\u6709\u539F\u5B50\u6027\u7684\uFF0C\u800C volatile \u53C8\u4FDD\u8BC1\u4E86\u53EF\u89C1\u6027\uFF0C\u6240\u4EE5\u5C31\u8DB3\u4EE5\u4FDD\u8BC1\u7EBF\u7A0B\u5B89\u5168\u3002
</code></pre></div><h4 id="_5-5-5-\u7528-volatile-\u4FEE\u6B63\u91CD\u6392\u5E8F\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_5-5-5-\u7528-volatile-\u4FEE\u6B63\u91CD\u6392\u5E8F\u95EE\u9898" aria-hidden="true">#</a> 5.5.5 \u7528 <code>volatile</code> \u4FEE\u6B63\u91CD\u6392\u5E8F\u95EE\u9898</h4><p><img src="`+F+'" alt="" loading="lazy"></p>',11),Z=a("\u76F8\u6BD4\u4E8E"),H=a("\u672A\u4FEE\u6B63\u7684\u4EE3\u7801"),K=a("\uFF0C\u8FD9\u91CC\u5C06\u53D8\u91CF "),G=e("code",null,"a,b,x,y",-1),O=a(" \u90FD\u7528 "),X=e("code",null,"volatile",-1),$=a(" \u4FEE\u9970\u4E86\u3002"),ee=n('<h4 id="_5-5-6-volatile-\u8865\u5145" tabindex="-1"><a class="header-anchor" href="#_5-5-6-volatile-\u8865\u5145" aria-hidden="true">#</a> 5.5.6 <code>volatile</code> \u8865\u5145</h4><ol><li><p><code>volatile</code> \u5C5E\u6027\u7684\u8BFB\u5199\u64CD\u4F5C\u90FD\u662F<strong>\u65E0\u9501\u7684</strong>\uFF0C\u5B83\u4E0D\u80FD\u4EE3\u66FF <code>synchronized</code>\uFF0C\u56E0\u4E3A\u5B83\u6CA1\u6709\u63D0\u4F9B\u539F\u5B50\u6027\u548C\u4E92\u65A5\u6027\u3002\u56E0\u4E3A\u65E0\u9501\uFF0C\u4E0D\u9700\u8981\u5728\u83B7\u53D6\u9501\u548C\u91CA\u653E\u9501\u4E0A\u82B1\u8D39\u65F6\u95F4\uFF0C\u6240\u4EE5\u8BF4\u5B83\u662F\u4F4E\u6210\u672C\u7684\u3002</p></li><li><p><code>volatile</code> \u53EF\u4EE5\u4F7F\u5F97 <code>long</code> \u548C <code>double</code> \u7684\u8D4B\u503C\u662F\u539F\u5B50\u7684\uFF08\u540E\u9762\u4F1A\u8BE6\u7EC6\u4ECB\u7ECD\uFF09\u3002</p></li></ol><h3 id="_5-6-\u80FD\u4FDD\u8BC1\u53EF\u89C1\u6027\u7684\u63AA\u65BD" tabindex="-1"><a class="header-anchor" href="#_5-6-\u80FD\u4FDD\u8BC1\u53EF\u89C1\u6027\u7684\u63AA\u65BD" aria-hidden="true">#</a> 5.6 \u80FD\u4FDD\u8BC1\u53EF\u89C1\u6027\u7684\u63AA\u65BD</h3><p>\u9664\u4E86 <code>volatile</code> \u53EF\u4EE5\u8BA9\u53D8\u91CF\u4FDD\u8BC1\u53EF\u89C1\u6027\u5916\uFF0C<code>synchronized</code>\u3001<code>Lock</code>\u3001\u5E76\u53D1\u96C6\u5408\u3001<code>Thread.join()</code> \u548C <code>Thread.start()</code> \u7B49\u90FD\u53EF\u4EE5\u4FDD\u8BC1\u53D8\u91CF\u7684\u53EF\u89C1\u6027\u3002</p><blockquote><p>\u5177\u4F53\u770B <code>happens-before</code> \u89C4\u5219\u7684\u89C4\u5B9A\u3002</p></blockquote><h3 id="_5-7-\u5BF9-synchronized-\u53EF\u89C1\u6027\u7684\u6B63\u786E\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#_5-7-\u5BF9-synchronized-\u53EF\u89C1\u6027\u7684\u6B63\u786E\u7406\u89E3" aria-hidden="true">#</a> 5.7 \u5BF9 <code>synchronized</code> \u53EF\u89C1\u6027\u7684\u6B63\u786E\u7406\u89E3</h3><ol><li><p><code>synchronized</code> \u4E0D\u4EC5\u4FDD\u8BC1\u4E86\u539F\u5B50\u6027\uFF0C\u8FD8\u4FDD\u8BC1\u4E86\u53EF\u89C1\u6027\u3002</p></li><li><p><code>synchronized</code> \u4E0D\u4EC5\u8BA9\u88AB\u4FDD\u62A4\u7684\u4EE3\u7801\u5B89\u5168\uFF0C\u8FD8\u8FD1\u6731\u8005\u8D64\uFF0C\u5982\u4E0B\u4EE3\u7801\u6240\u793A\uFF1A</p><p><img src="'+T+`" alt="" loading="lazy"></p></li></ol><h2 id="_6-\u539F\u5B50\u6027" tabindex="-1"><a class="header-anchor" href="#_6-\u539F\u5B50\u6027" aria-hidden="true">#</a> 6. \u539F\u5B50\u6027</h2><h3 id="_6-1-\u4EC0\u4E48\u662F\u539F\u5B50\u6027" tabindex="-1"><a class="header-anchor" href="#_6-1-\u4EC0\u4E48\u662F\u539F\u5B50\u6027" aria-hidden="true">#</a> 6.1 \u4EC0\u4E48\u662F\u539F\u5B50\u6027</h3><p>\u4E0D\u7BA1\u662F\u4E00\u6761\u8BED\u53E5\u7684\u64CD\u4F5C\uFF0C\u8FD8\u662F\u591A\u6761\u8BED\u53E5\u7684\u64CD\u4F5C\uFF0C\u53EA\u8981\u64CD\u4F5C\u6EE1\u8DB3 \u201C\u8981\u4E48\u5168\u90E8\u6267\u884C\u6210\u529F\uFF0C\u8981\u4E48\u5168\u90E8\u4E0D\u6267\u884C\uFF0C\u4E0D\u4F1A\u51FA\u73B0\u53EA\u6267\u884C\u4E00\u534A\u7684\u60C5\u51B5\u201D \u7684\u6761\u4EF6\uFF0C\u90A3\u4E48\u5C31\u8BF4\u8FD9\u6837\u7684\u64CD\u4F5C\u5177\u4F53\u539F\u5B50\u6027\u3002</p><blockquote><p>\u5373\uFF1A\u5177\u5907\u539F\u5B50\u6027\u7684\u64CD\u4F5C\u662F\u4E00\u4E2A\u4E0D\u53EF\u5206\u5272\u7684 \u201C\u6574\u4F53\u201D\u3002</p></blockquote><blockquote><p>\u73B0\u5B9E\u4E2D\uFF0C\u5982 \u201CATM\u91CC\u53D6\u94B1\u201D \u8FD9\u6837\u7684\u64CD\u4F5C\u662F\u5177\u5907\u539F\u5B50\u6027\u7684\uFF1B</p><p>\u4EE3\u7801\u4E2D\uFF0C\u7528 <code>synchronized</code> \u5305\u88F9\u7684\u540C\u6B65\u4EE3\u7801\u5757\u7EC4\u6210\u7684\u64CD\u4F5C\u662F\u5177\u5907\u539F\u5B50\u6027\u7684</p></blockquote><blockquote><p>\u6CE8\u610F\uFF1A<code>i++</code> \u64CD\u4F5C\u4E0D\u5177\u5907\u539F\u5B50\u6027\uFF0C\u8BE5\u64CD\u4F5C\u53EF\u5206\u89E3\u4E3A tmp=a+1 \u548C a=tmp \u4E24\u4E2A\u64CD\u4F5C\u3002</p></blockquote><h3 id="_6-2-java-\u4E2D\u7684\u539F\u5B50\u64CD\u4F5C\u6709\u54EA\u4E9B" tabindex="-1"><a class="header-anchor" href="#_6-2-java-\u4E2D\u7684\u539F\u5B50\u64CD\u4F5C\u6709\u54EA\u4E9B" aria-hidden="true">#</a> 6.2 <code>Java</code> \u4E2D\u7684\u539F\u5B50\u64CD\u4F5C\u6709\u54EA\u4E9B</h3><p>\u539F\u5B50\u64CD\u4F5C\u53EF\u4EE5\u7406\u89E3\u4E3A\u5177\u5907\u539F\u5B50\u6027\u7684\u53EA\u5305\u542B\u4E00\u6761\u8BED\u53E5\u7684\u64CD\u4F5C\u3002</p><blockquote><p>\u5982\u679C\u60F3\u8981\u5305\u542B\u591A\u6761\u8BED\u53E5\u7684\u64CD\u4F5C\u5177\u5907\u539F\u5B50\u6027\uFF0C\u53EF\u4EE5\u4F7F\u7528 <code>synchronized</code> \u5173\u952E\u5B57\u3002</p></blockquote><p><code>Java</code> \u4E2D\u7684\u539F\u5B50\u64CD\u4F5C\u6709\uFF1A</p><ol><li><p>\u9664 <code>long</code> \u548C <code>double</code> \u4E4B\u5916\u7684\u57FA\u672C\u7C7B\u578B\uFF08<code>int</code>\u3001<code>byte</code>\u3001<code>boolean</code>\u3001<code>short</code>\u3001<code>char</code>\u3001<code>float</code>\uFF09\u7684\u8D4B\u503C\u64CD\u4F5C\uFF1B</p><blockquote><p>\u4E0D\u80FD\u662F\u590D\u5408\u8D4B\u503C\u64CD\u4F5C\uFF0C\u4E14\u53F3\u64CD\u4F5C\u6570\u662F\u53D8\u91CF\u6216\u5E38\u91CF\uFF0C\u4E0D\u80FD\u662F\u8868\u8FBE\u5F0F\u6216\u51FD\u6570\u3002</p></blockquote></li><li><p>\u6240\u6709\u5F15\u7528 <code>reference</code> \u7684\u8D4B\u503C\u64CD\u4F5C\uFF0C\u4E0D\u7BA1\u662F <code>32</code> \u4F4D\u7684\u673A\u5668\u8FD8\u662F <code>64</code> \u4F4D\u7684\u673A\u5668\u3002</p><blockquote><p>\u4E0D\u80FD\u662F\u590D\u5408\u8D4B\u503C\u64CD\u4F5C\uFF0C\u4E14\u53F3\u64CD\u4F5C\u6570\u662F\u53D8\u91CF\u6216\u5E38\u91CF\uFF0C\u4E0D\u80FD\u662F\u8868\u8FBE\u5F0F\u6216\u51FD\u6570\u3002</p></blockquote></li><li><p><code>java.concurrent.Atomic.*</code> \u5305\u4E2D\u6240\u6709\u7C7B\u7684\u539F\u5B50\u64CD\u4F5C\u3002</p></li></ol><h3 id="_6-3-long-\u548C-double-\u7684\u539F\u5B50\u6027" tabindex="-1"><a class="header-anchor" href="#_6-3-long-\u548C-double-\u7684\u539F\u5B50\u6027" aria-hidden="true">#</a> 6.3 <code>long</code> \u548C <code>double</code> \u7684\u539F\u5B50\u6027</h3><p>\u5B98\u65B9\u6587\u6863\u63D0\u51FA\uFF1A</p><div class="language-text ext-text"><pre class="language-text"><code>\u5BF9\u4E8E\u5360 8 \u5B57\u8282\uFF0864 \u4F4D\uFF09\u7684 long \u7C7B\u578B\u53D8\u91CF\u548C double \u7C7B\u578B\u53D8\u91CF\u7684\u8D4B\u503C\u64CD\u4F5C\uFF0C
\u5728 32 \u4F4D\u64CD\u4F5C\u7CFB\u7EDF\u4E2D\u4E0D\u5177\u5907\u539F\u5B50\u6027\uFF0C\u5728 64 \u4F4D\u7684\u64CD\u4F5C\u7CFB\u7EDF\u4E2D\u5219\u5177\u5907\u539F\u5B50\u6027\u3002

\u56E0\u4E3A long \u6216 double \u5360 64 \u4F4D\uFF0C\u6240\u4EE5\u5728 32 \u4F4D\u64CD\u4F5C\u7CFB\u7EDF\u4E2D\u5411 long \u6216 double \u7C7B\u578B\u7684\u53D8\u91CF\u5199\u5165\u6570\u636E\u65F6\uFF0C\u4F1A\u5206\u4E24\u6B21\u5199\u5165\uFF08\u6BCF\u6B21\u5199 32 \u4F4D\u6570\u636E\uFF09\u3002
\u4E3A\u4E86\u4FDD\u8BC1 long \u6216 double \u7C7B\u578B\u53D8\u91CF\u7684\u8D4B\u503C\u64CD\u4F5C\u5177\u5907\u539F\u5B50\u6027\uFF0C\u5E94\u8BE5\u4F7F\u7528 volatile \u4FEE\u9970 long \u6216 double \u7C7B\u578B\u7684\u53D8\u91CF\u3002
</code></pre></div><blockquote><p>\u5BF9\u4E8E\u5546\u7528\u7684 <code>Java</code> \u865A\u62DF\u673A\uFF0C<code>JVM</code> \u5185\u90E8\u5DF2\u7ECF\u4FDD\u8BC1\u4E86 <code>long</code> \u6216 <code>double</code> \u7C7B\u578B\u53D8\u91CF\u7684\u8D4B\u503C\u64CD\u4F5C\u5177\u5907\u539F\u5B50\u6027\u3002\u56E0\u6B64\uFF0C\u5B9E\u9645\u5F00\u53D1\u4E2D\uFF0C\u4E0D\u518D\u9700\u8981\u4E3A\u4E86\u4FDD\u8BC1 <code>long</code> \u6216 <code>double</code> \u7C7B\u578B\u53D8\u91CF\u7684\u8D4B\u503C\u64CD\u4F5C\u5177\u5907\u539F\u5B50\u6027\uFF0C\u800C\u4F7F\u7528 <code>volatile</code> \u5173\u952E\u5B57\u4FEE\u9970\u5B83\u4EEC\u3002</p></blockquote><p><img src="`+U+'" alt="" loading="lazy"></p><h3 id="_6-4-\u539F\u5B50\u64CD\u4F5C-\u539F\u5B50\u64CD\u4F5C-\u539F\u5B50\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_6-4-\u539F\u5B50\u64CD\u4F5C-\u539F\u5B50\u64CD\u4F5C-\u539F\u5B50\u64CD\u4F5C" aria-hidden="true">#</a> 6.4 \u539F\u5B50\u64CD\u4F5C + \u539F\u5B50\u64CD\u4F5C != \u539F\u5B50\u64CD\u4F5C</h3><p>\u7B80\u5355\u5730\u628A\u539F\u5B50\u64CD\u4F5C\u7EC4\u5408\u5728\u4E00\u8D77\uFF0C\u5E76\u4E0D\u80FD\u4FDD\u8BC1\u6574\u4F53\u4F9D\u7136\u5177\u6709\u539F\u5B50\u6027\u3002</p><blockquote><p>\u6BD4\u5982\u53BB <code>ATM</code> \u673A\u4E24\u6B21\u53D6\u94B1\u662F\u4E24\u6B21\u72EC\u7ACB\u7684\u539F\u5B50\u64CD\u4F5C\uFF0C\u4F46\u662F\u671F\u95F4\u6709\u53EF\u80FD\u94F6\u884C\u5361\u88AB\u501F\u7ED9\u5973\u670B\u53CB\uFF0C\u4E5F\u5C31\u662F\u88AB\u5176\u4ED6\u7EBF\u7A0B\u6253\u65AD\u5E76\u88AB\u4FEE\u6539\u3002</p></blockquote><p>\u53E6\u5916\uFF0C\u5168\u540C\u6B65\u7684 <code>HashMap</code> \u4E5F\u4E0D\u5B8C\u5168\u5B89\u5168\u3002</p><blockquote><p>\u5373\u4F7F <code>HashMap</code> \u7684\u5199\u64CD\u4F5C\u5177\u5907\u539F\u5B50\u6027\uFF08\u5982\u7528 <code>synchronized</code> \u4FEE\u9970 <code>put</code> \u65B9\u6CD5\uFF09\uFF0C\u8BFB\u64CD\u4F5C\u4E5F\u5177\u5907\u539F\u5B50\u6027\uFF08\u5982\u7528 <code>synchronized</code> \u4FEE\u9970 <code>get</code> \u65B9\u6CD5\uFF09\u3002\u4F46\u662F\uFF0C\u7531\u8BFB\u64CD\u4F5C\u548C\u5199\u64CD\u4F5C\u7EC4\u6210\u7684\u64CD\u4F5C\u5374\u4E0D\u5177\u5907\u539F\u5B50\u6027\uFF0C\u5373\u5728\u8BFB\u64CD\u4F5C\u548C\u5199\u64CD\u4F5C\u4E4B\u95F4\u53EF\u80FD\u4F1A\u51FA\u73B0\u7EBF\u7A0B\u5207\u6362\u7684\u60C5\u51B5\uFF0C\u4ECE\u800C\u5F15\u8D77\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\u3002</p></blockquote><h2 id="_7-jmm-\u7684\u5E94\u7528-\u53CC\u91CD\u68C0\u67E5\u5B9E\u73B0\u5355\u4F8B" tabindex="-1"><a class="header-anchor" href="#_7-jmm-\u7684\u5E94\u7528-\u53CC\u91CD\u68C0\u67E5\u5B9E\u73B0\u5355\u4F8B" aria-hidden="true">#</a> 7. <code>JMM</code> \u7684\u5E94\u7528\uFF08\u53CC\u91CD\u68C0\u67E5\u5B9E\u73B0\u5355\u4F8B\uFF09</h2>',29),ae=a("\u53C2\u8003");function oe(de,ce){const o=t("RouterLink");return r(),s(i,null,[C,e("blockquote",null,[e("p",null,[P,d(o,{to:"/zkq/java/jvm/memory-allocate.html#_2-3-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80-%E5%AF%B9%E8%B1%A1%E5%A4%B4%E3%80%81%E5%AE%9E%E4%BE%8B%E6%95%B0%E6%8D%AE%E3%80%81%E5%AF%B9%E9%BD%90%E5%A1%AB%E5%85%85"},{default:c(()=>[Q]),_:1})]),e("p",null,[Y,d(o,{to:"/zkq/java/jvm/memory-allocate.html#_2-4-%E5%AF%B9%E8%B1%A1%E7%9A%84%E8%AE%BF%E9%97%AE%E6%96%B9%E5%BC%8F-%E4%BD%BF%E7%94%A8%E5%8F%A5%E6%9F%84%E3%80%81%E4%BD%BF%E7%94%A8%E6%8C%87%E9%92%88"},{default:c(()=>[S]),_:1})])]),N,e("ol",null,[R,e("li",null,[D,e("blockquote",null,[e("p",null,[d(o,{to:"/zkq/design-pattern/singleton-pattern.html#%E5%8F%8C%E9%87%8D%E6%A3%80%E6%9F%A5%E3%80%90%E6%8E%A8%E8%8D%90%E7%94%A8%E3%80%91"},{default:c(()=>[L]),_:1})])])])]),I,e("p",null,[Z,d(o,{to:"/zkq/project-experiences/project-list/others/java-jmm.html#_4-1-%E4%BB%80%E4%B9%88%E6%98%AF%E9%87%8D%E6%8E%92%E5%BA%8F"},{default:c(()=>[H]),_:1}),K,G,O,X,$]),ee,e("p",null,[d(o,{to:"/zkq/design-pattern/singleton-pattern.html#%E5%8F%8C%E9%87%8D%E6%A3%80%E6%9F%A5%E3%80%90%E6%8E%A8%E8%8D%90%E7%94%A8%E3%80%91"},{default:c(()=>[ae]),_:1})])],64)}var le=l(W,[["render",oe],["__file","jmm.html.vue"]]);export{le as default};
