<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.38" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://zengkaiqiang562.github.io/zkq/android/ndk/ndk-build.html"><meta property="og:site_name" content="Android Guide"><meta property="og:title" content="ndk-build（Makefile）（TODO）"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-07-18T10:01:37.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="android-ndk"><meta property="article:modified_time" content="2022-07-18T10:01:37.000Z"><script>var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?5dd2e8c97962d57b7b8fea1737c01743";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2922463_99aa80ii7cf.css"><title>ndk-build（Makefile）（TODO） | Android Guide</title><meta name="description" content="Android 学习 && 面试指南">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.c9a516cc.css">
    <link rel="modulepreload" href="/assets/app.2a01fc36.js"><link rel="modulepreload" href="/assets/ndk-build.html.2431e84f.js"><link rel="modulepreload" href="/assets/ndk-build.html.a13362cb.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/" class="home-link"><img class="logo" src="/logo.png" alt="Android Guide"><!----><span class="site-name hide-in-pad">Android Guide</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/home.html" class="nav-link" arialabel="面试指南"><i class="icon iconfont icon-java"></i>面试指南<!----></a></div><div class="nav-item hide-in-mobile"><a href="/zhuanlan/" class="nav-link" arialabel="优质专栏"><i class="icon iconfont icon-recommend"></i>优质专栏<!----></a></div><div class="nav-item hide-in-mobile"><a href="/open-source-project/" class="nav-link" arialabel="项目精选"><i class="icon iconfont icon-github"></i>项目精选<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://snailclimb.gitee.io/javaguide/#/" rel="noopener noreferrer" target="_blank" arialabel="旧版链接" class="nav-link"><i class="icon iconfont icon-java"></i>旧版链接<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="nav-item hide-in-mobile"><a href="https://javaguide.cn/feed.json" rel="noopener noreferrer" target="_blank" arialabel="RSS订阅" class="nav-link"><i class="icon iconfont icon-rss"></i>RSS订阅<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="nav-item hide-in-mobile"><a href="/about-the-author/" class="nav-link" arialabel="关于作者"><i class="icon iconfont icon-zuozhe"></i>关于作者<!----></a></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/zengkaiqiang562/JavaGuide" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" arialabelledby="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><title id="github" lang="en">github icon</title><g fill="currentColor"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></g></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" arialabelledby="auto" style="display:block;"><title id="auto" lang="en">auto icon</title><g fill="currentColor"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></g></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" arialabelledby="dark" style="display:none;"><title id="dark" lang="en">dark icon</title><g fill="currentColor"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></g></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" arialabelledby="light" style="display:none;"><title id="light" lang="en">light icon</title><g fill="currentColor"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></g></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">基础</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">绘图基础</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">动画</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">UI</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Jetpack</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">NDK</span><span class="arrow down"></span></button><!--[--><!--[--><ul class="sidebar-links"><li><!--[--><a href="/zkq/android/ndk/jni.html" class="nav-link sidebar-link sidebar-page" arialabel="JNI"><!---->JNI<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/zkq/android/ndk/ndk-build.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" arialabel="ndk-build（Makefile）（TODO）"><!---->ndk-build（Makefile）（TODO）<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-android-mk" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1. Android.mk"><!---->1. Android.mk<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-1-android-mk-的基本配置" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.1 Android.mk 的基本配置"><!---->1.1 Android.mk 的基本配置<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-android-mk-中使用的变量和宏" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2 Android.mk 中使用的变量和宏"><!---->1.2 Android.mk 中使用的变量和宏<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-ndk-构建系统定义的-include-相关的变量" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.1 NDK 构建系统定义的 include 相关的变量"><!---->1.2.1 NDK 构建系统定义的 include 相关的变量<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-1-clear-vars" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.1.1 CLEAR_VARS"><!---->1.2.1.1 CLEAR_VARS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-2-build-executable" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.1.2 BUILD_EXECUTABLE"><!---->1.2.1.2 BUILD_EXECUTABLE<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-3-build-shared-library" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.1.3 BUILD_SHARED_LIBRARY"><!---->1.2.1.3 BUILD_SHARED_LIBRARY<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-4-build-static-library" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.1.4 BUILD_STATIC_LIBRARY"><!---->1.2.1.4 BUILD_STATIC_LIBRARY<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-5-prebuilt-shared-library" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.1.5 PREBUILT_SHARED_LIBRARY"><!---->1.2.1.5 PREBUILT_SHARED_LIBRARY<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-6-prebuilt-static-library" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.1.6 PREBUILT_STATIC_LIBRARY"><!---->1.2.1.6 PREBUILT_STATIC_LIBRARY<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-ndk-构建系统定义的模块构建产物相关的变量" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.2 NDK 构建系统定义的模块构建产物相关的变量"><!---->1.2.2 NDK 构建系统定义的模块构建产物相关的变量<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-1-cpu-架构-abi" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.2.1 CPU 架构 &amp; ABI"><!---->1.2.2.1 CPU 架构 &amp; ABI<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-2-target-arch" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.2.2 TARGET_ARCH"><!---->1.2.2.2 TARGET_ARCH<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-3-target-platform" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.2.3 TARGET_PLATFORM"><!---->1.2.2.3 TARGET_PLATFORM<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-4-target-arch-abi" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.2.4 TARGET_ARCH_ABI"><!---->1.2.2.4 TARGET_ARCH_ABI<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-5-target-abi" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.2.5 TARGET_ABI"><!---->1.2.2.5 TARGET_ABI<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-ndk-构建系统定义的描述模块的变量" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3 NDK 构建系统定义的描述模块的变量"><!---->1.2.3 NDK 构建系统定义的描述模块的变量<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-1-android-mk-中描述-定义-模块的基本流程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.1 Android.mk 中描述（定义）模块的基本流程"><!---->1.2.3.1 Android.mk 中描述（定义）模块的基本流程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-2-local-path" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.2 LOCAL_PATH"><!---->1.2.3.2 LOCAL_PATH<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-3-local-module" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.3 LOCAL_MODULE"><!---->1.2.3.3 LOCAL_MODULE<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-4-local-module-filename" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.4 LOCAL_MODULE_FILENAME"><!---->1.2.3.4 LOCAL_MODULE_FILENAME<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-5-local-src-files" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.5 LOCAL_SRC_FILES"><!---->1.2.3.5 LOCAL_SRC_FILES<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-6-local-cpp-extension" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.6 LOCAL_CPP_EXTENSION"><!---->1.2.3.6 LOCAL_CPP_EXTENSION<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-7-local-cpp-features" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.7 LOCAL_CPP_FEATURES"><!---->1.2.3.7 LOCAL_CPP_FEATURES<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-8-local-c-includes" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.8 LOCAL_C_INCLUDES"><!---->1.2.3.8 LOCAL_C_INCLUDES<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-9-local-cflags" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.9 LOCAL_CFLAGS"><!---->1.2.3.9 LOCAL_CFLAGS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-10-local-cppflags" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.10 LOCAL_CPPFLAGS"><!---->1.2.3.10 LOCAL_CPPFLAGS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-11-local-static-libraries" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.11 LOCAL_STATIC_LIBRARIES"><!---->1.2.3.11 LOCAL_STATIC_LIBRARIES<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-12-local-shared-libraries" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.12 LOCAL_SHARED_LIBRARIES"><!---->1.2.3.12 LOCAL_SHARED_LIBRARIES<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-13-local-whole-static-libraries" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.13 LOCAL_WHOLE_STATIC_LIBRARIES"><!---->1.2.3.13 LOCAL_WHOLE_STATIC_LIBRARIES<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-14-local-ldlibs" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.14 LOCAL_LDLIBS"><!---->1.2.3.14 LOCAL_LDLIBS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-15-local-ldflags" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.15 LOCAL_LDFLAGS"><!---->1.2.3.15 LOCAL_LDFLAGS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-16-local-allow-undefined-symbols" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.16 LOCAL_ALLOW_UNDEFINED_SYMBOLS"><!---->1.2.3.16 LOCAL_ALLOW_UNDEFINED_SYMBOLS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-17-local-arm-mode" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.17 LOCAL_ARM_MODE"><!---->1.2.3.17 LOCAL_ARM_MODE<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-18-local-arm-neon" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.18 LOCAL_ARM_NEON"><!---->1.2.3.18 LOCAL_ARM_NEON<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-19-local-disable-format-string-checks" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.19 LOCAL_DISABLE_FORMAT_STRING_CHECKS"><!---->1.2.3.19 LOCAL_DISABLE_FORMAT_STRING_CHECKS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-20-local-export-cflags" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.20 LOCAL_EXPORT_CFLAGS"><!---->1.2.3.20 LOCAL_EXPORT_CFLAGS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-21-local-export-cppflags" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.21 LOCAL_EXPORT_CPPFLAGS"><!---->1.2.3.21 LOCAL_EXPORT_CPPFLAGS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-22-local-export-c-includes" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.22 LOCAL_EXPORT_C_INCLUDES"><!---->1.2.3.22 LOCAL_EXPORT_C_INCLUDES<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-23-local-export-ldflags" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.23 LOCAL_EXPORT_LDFLAGS"><!---->1.2.3.23 LOCAL_EXPORT_LDFLAGS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-24-local-export-ldlibs" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.24 LOCAL_EXPORT_LDLIBS"><!---->1.2.3.24 LOCAL_EXPORT_LDLIBS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-25-local-short-commands" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.25 LOCAL_SHORT_COMMANDS"><!---->1.2.3.25 LOCAL_SHORT_COMMANDS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-26-local-thin-archive" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.26 LOCAL_THIN_ARCHIVE"><!---->1.2.3.26 LOCAL_THIN_ARCHIVE<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-27-local-filter-asm" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.2.3.27 LOCAL_FILTER_ASM"><!---->1.2.3.27 LOCAL_FILTER_ASM<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-3-预构建库" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.3 预构建库"><!---->1.3 预构建库<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-3-1-导出预构建库的头文件" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.3.1 导出预构建库的头文件"><!---->1.3.1 导出预构建库的头文件<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-ndk-提供的函数宏" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.4 NDK 提供的函数宏"><!---->1.4 NDK 提供的函数宏<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-1-my-dir" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.4.1 my-dir"><!---->1.4.1 my-dir<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-2-all-subdir-makefiles" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.4.2 all-subdir-makefiles"><!---->1.4.2 all-subdir-makefiles<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-3-this-makefile" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.4.3 this-makefile"><!---->1.4.3 this-makefile<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-4-parent-makefile" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.4.4 parent-makefile"><!---->1.4.4 parent-makefile<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-5-grand-parent-makefile" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.4.5 grand-parent-makefile"><!---->1.4.5 grand-parent-makefile<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-6-import-module" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="1.4.6 import-module"><!---->1.4.6 import-module<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_2-application-mk" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="2. Application.mk"><!---->2. Application.mk<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/zkq/android/ndk/cmake.html" class="nav-link sidebar-link sidebar-page" arialabel="CMake（TODO）"><!---->CMake（TODO）<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">IPC</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">蓝牙开发</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">性能优化</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">系统源码分析</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">其他</span><span class="arrow right"></span></button><!--[--><!--[--><!----><!--]--><!----><!--]--></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->ndk-build（Makefile）（TODO）</h1><div class="article-info"><span class="author-info" arialabel="作者🖊" isoriginal="false" pageview="false" color="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" arialabelledby="author"><title id="author" lang="en">author icon</title><g fill="currentColor"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></g></svg><span><a class="author-item" href="https://zengkaiqiang562.github.io/" target="_blank" rel="noopener noreferrer">Zenk562</a></span><span property="author" content="Zenk562"></span></span><span class="category-info" arialabel="分类🌈" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" arialabelledby="category"><title id="category" lang="en">category icon</title><g fill="currentColor"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></g></svg><ul class="categories-wrapper"><li class="category clickable" role="navigation">android-ndk</li><meta property="articleSection" content="android-ndk"></ul></span><span arialabel="标签🏷" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" arialabelledby="tag"><title id="tag" lang="en">tag icon</title><g fill="currentColor"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></g></svg><ul class="tags-wrapper"><li class="tag clickable" role="navigation">android-ndk</li></ul><meta property="keywords" content="android-ndk"></span><span class="date-info" arialabel="写作日期📅" isoriginal="false" pageview="false" color="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" arialabelledby="calendar"><title id="calendar" lang="en">calendar icon</title><g fill="currentColor"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></g></svg><span>2022年7月10日</span><meta property="datePublished" content="2022-07-10T14:36:08.000Z"></span><!----><span class="words-info" arialabel="字数🔠" isoriginal="false" pageview="false" color="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewbox="0 0 1024 1024" arialabelledby="word"><title id="word" lang="en">word icon</title><g fill="currentColor"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></g></svg><span>约 7157 字</span><meta property="wordCount" content="7157"></span></div><hr></div><div class="toc-place-holder"><aside id="toc-list"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-android-mk" class="router-link-active router-link-exact-active toc-link level2">1. Android.mk</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-1-android-mk-的基本配置" class="router-link-active router-link-exact-active toc-link level3">1.1 Android.mk 的基本配置</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-android-mk-中使用的变量和宏" class="router-link-active router-link-exact-active toc-link level3">1.2 Android.mk 中使用的变量和宏</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-ndk-构建系统定义的-include-相关的变量" class="router-link-active router-link-exact-active toc-link level4">1.2.1 NDK 构建系统定义的 include 相关的变量</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-1-clear-vars" class="router-link-active router-link-exact-active toc-link level5">1.2.1.1 CLEAR_VARS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-2-build-executable" class="router-link-active router-link-exact-active toc-link level5">1.2.1.2 BUILD_EXECUTABLE</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-3-build-shared-library" class="router-link-active router-link-exact-active toc-link level5">1.2.1.3 BUILD_SHARED_LIBRARY</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-4-build-static-library" class="router-link-active router-link-exact-active toc-link level5">1.2.1.4 BUILD_STATIC_LIBRARY</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-5-prebuilt-shared-library" class="router-link-active router-link-exact-active toc-link level5">1.2.1.5 PREBUILT_SHARED_LIBRARY</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-1-6-prebuilt-static-library" class="router-link-active router-link-exact-active toc-link level5">1.2.1.6 PREBUILT_STATIC_LIBRARY</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-ndk-构建系统定义的模块构建产物相关的变量" class="router-link-active router-link-exact-active toc-link level4">1.2.2 NDK 构建系统定义的模块构建产物相关的变量</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-1-cpu-架构-abi" class="router-link-active router-link-exact-active toc-link level5">1.2.2.1 CPU 架构 &amp; ABI</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-2-target-arch" class="router-link-active router-link-exact-active toc-link level5">1.2.2.2 TARGET_ARCH</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-3-target-platform" class="router-link-active router-link-exact-active toc-link level5">1.2.2.3 TARGET_PLATFORM</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-4-target-arch-abi" class="router-link-active router-link-exact-active toc-link level5">1.2.2.4 TARGET_ARCH_ABI</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-2-5-target-abi" class="router-link-active router-link-exact-active toc-link level5">1.2.2.5 TARGET_ABI</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-ndk-构建系统定义的描述模块的变量" class="router-link-active router-link-exact-active toc-link level4">1.2.3 NDK 构建系统定义的描述模块的变量</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-1-android-mk-中描述-定义-模块的基本流程" class="router-link-active router-link-exact-active toc-link level5">1.2.3.1 Android.mk 中描述（定义）模块的基本流程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-2-local-path" class="router-link-active router-link-exact-active toc-link level5">1.2.3.2 LOCAL_PATH</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-3-local-module" class="router-link-active router-link-exact-active toc-link level5">1.2.3.3 LOCAL_MODULE</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-4-local-module-filename" class="router-link-active router-link-exact-active toc-link level5">1.2.3.4 LOCAL_MODULE_FILENAME</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-5-local-src-files" class="router-link-active router-link-exact-active toc-link level5">1.2.3.5 LOCAL_SRC_FILES</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-6-local-cpp-extension" class="router-link-active router-link-exact-active toc-link level5">1.2.3.6 LOCAL_CPP_EXTENSION</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-7-local-cpp-features" class="router-link-active router-link-exact-active toc-link level5">1.2.3.7 LOCAL_CPP_FEATURES</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-8-local-c-includes" class="router-link-active router-link-exact-active toc-link level5">1.2.3.8 LOCAL_C_INCLUDES</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-9-local-cflags" class="router-link-active router-link-exact-active toc-link level5">1.2.3.9 LOCAL_CFLAGS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-10-local-cppflags" class="router-link-active router-link-exact-active toc-link level5">1.2.3.10 LOCAL_CPPFLAGS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-11-local-static-libraries" class="router-link-active router-link-exact-active toc-link level5">1.2.3.11 LOCAL_STATIC_LIBRARIES</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-12-local-shared-libraries" class="router-link-active router-link-exact-active toc-link level5">1.2.3.12 LOCAL_SHARED_LIBRARIES</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-13-local-whole-static-libraries" class="router-link-active router-link-exact-active toc-link level5">1.2.3.13 LOCAL_WHOLE_STATIC_LIBRARIES</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-14-local-ldlibs" class="router-link-active router-link-exact-active toc-link level5">1.2.3.14 LOCAL_LDLIBS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-15-local-ldflags" class="router-link-active router-link-exact-active toc-link level5">1.2.3.15 LOCAL_LDFLAGS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-16-local-allow-undefined-symbols" class="router-link-active router-link-exact-active toc-link level5">1.2.3.16 LOCAL_ALLOW_UNDEFINED_SYMBOLS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-17-local-arm-mode" class="router-link-active router-link-exact-active toc-link level5">1.2.3.17 LOCAL_ARM_MODE</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-18-local-arm-neon" class="router-link-active router-link-exact-active toc-link level5">1.2.3.18 LOCAL_ARM_NEON</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-19-local-disable-format-string-checks" class="router-link-active router-link-exact-active toc-link level5">1.2.3.19 LOCAL_DISABLE_FORMAT_STRING_CHECKS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-20-local-export-cflags" class="router-link-active router-link-exact-active toc-link level5">1.2.3.20 LOCAL_EXPORT_CFLAGS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-21-local-export-cppflags" class="router-link-active router-link-exact-active toc-link level5">1.2.3.21 LOCAL_EXPORT_CPPFLAGS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-22-local-export-c-includes" class="router-link-active router-link-exact-active toc-link level5">1.2.3.22 LOCAL_EXPORT_C_INCLUDES</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-23-local-export-ldflags" class="router-link-active router-link-exact-active toc-link level5">1.2.3.23 LOCAL_EXPORT_LDFLAGS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-24-local-export-ldlibs" class="router-link-active router-link-exact-active toc-link level5">1.2.3.24 LOCAL_EXPORT_LDLIBS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-25-local-short-commands" class="router-link-active router-link-exact-active toc-link level5">1.2.3.25 LOCAL_SHORT_COMMANDS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-26-local-thin-archive" class="router-link-active router-link-exact-active toc-link level5">1.2.3.26 LOCAL_THIN_ARCHIVE</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-2-3-27-local-filter-asm" class="router-link-active router-link-exact-active toc-link level5">1.2.3.27 LOCAL_FILTER_ASM</a></li><!----><!--]--></ul><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-3-预构建库" class="router-link-active router-link-exact-active toc-link level3">1.3 预构建库</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-3-1-导出预构建库的头文件" class="router-link-active router-link-exact-active toc-link level4">1.3.1 导出预构建库的头文件</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-ndk-提供的函数宏" class="router-link-active router-link-exact-active toc-link level3">1.4 NDK 提供的函数宏</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-1-my-dir" class="router-link-active router-link-exact-active toc-link level4">1.4.1 my-dir</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-2-all-subdir-makefiles" class="router-link-active router-link-exact-active toc-link level4">1.4.2 all-subdir-makefiles</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-3-this-makefile" class="router-link-active router-link-exact-active toc-link level4">1.4.3 this-makefile</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-4-parent-makefile" class="router-link-active router-link-exact-active toc-link level4">1.4.4 parent-makefile</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-5-grand-parent-makefile" class="router-link-active router-link-exact-active toc-link level4">1.4.5 grand-parent-makefile</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_1-4-6-import-module" class="router-link-active router-link-exact-active toc-link level4">1.4.6 import-module</a></li><!----><!--]--></ul><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zkq/android/ndk/ndk-build.html#_2-application-mk" class="router-link-active router-link-exact-active toc-link level2">2. Application.mk</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><p><code>ndk-build</code> 通过 <code>Makefile</code> 脚本构建原生库项目。</p><p><code>ndk-build</code> 使用 <code>Android.mk</code> 和 <code>Application.mk</code> 这两个构建文件来配置原生库项目。</p><h2 id="_1-android-mk" tabindex="-1"><a class="header-anchor" href="#_1-android-mk" aria-hidden="true">#</a> 1. <code>Android.mk</code></h2><blockquote><p>参考：<a href="https://developer.android.google.cn/ndk/guides/android_mk?hl=zh-cn" target="_blank" rel="noopener noreferrer">Android.mk<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p><code>Android.mk</code> 文件一般放在模块的 <code>jni/</code> 目录下，用于向 <code>NDK</code> 构建系统描述源文件和共享库。</p><blockquote><p><code>jni/</code> 目录可用来存放构建原生库所需的源文件、头文件、<code>Android.mk</code> 文件。</p><p><code>jni/</code> 目录的默认路径是 <code>src/main/jni/</code>。可以在 <code>build.gradle</code> 中通过 <code>jni.srcDirs</code> 属性进行修改：</p><div class="language-groovy ext-groovy"><pre class="language-groovy"><code>android <span class="token punctuation">{</span>
    <span class="token punctuation">...</span>
    sourceSets<span class="token punctuation">.</span>main <span class="token punctuation">{</span>
        jni<span class="token punctuation">.</span>srcDirs <span class="token string">&#39;src/main/jni_src&#39;</span> <span class="token comment">// 指定存放 C/C++ 源码的目录为 app/src/main/jni_src</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></blockquote><p><code>Android.mk</code> 文件实际上是一个微小的 <code>GNU makefile</code> 片段，构建系统会对 <code>Android.mk</code> 解析一次或多次。</p><p>通过 <code>Android.mk</code> 文件，可以将 <code>jni/</code> 目录下的源文件分组为多个模块（<code>Module</code>）。一个模块的构建产物可以一个静态库；或一个共享库（<code>so</code> 动态库）；或一个独立的可执行文件。</p><blockquote><p>注意：</p><ol><li><p><code>Android.mk</code> 中可以定义一个或多个模块；</p></li><li><p><code>Android.mk</code> 中定义的不同模块中可以使用同一个源文件。</p></li><li><p><code>NDK</code> 构建系统只会将构建生成的共享库（<code>so</code> 动态库）放入到 <code>apk</code> 文件中。</p></li><li><p>静态库可生成共享库，即可以在 <code>Android.mk</code> 中对一个构建生成共享库的模块进行配置，向模块中导入静态库，于是静态库就会参与共享库的构建，达到将静态库转换成共享库的目的。</p></li></ol></blockquote><h3 id="_1-1-android-mk-的基本配置" tabindex="-1"><a class="header-anchor" href="#_1-1-android-mk-的基本配置" aria-hidden="true">#</a> 1.1 <code>Android.mk</code> 的基本配置</h3><blockquote><p>参考：示例代码 <a href="https://github.com/android/ndk-samples/blob/android-mk/hello-jni/jni/Android.mk" target="_blank" rel="noopener noreferrer">hello-jni<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> my-dir<span class="token punctuation">)</span>

<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>CLEAR_VARS<span class="token punctuation">)</span>

LOCAL_MODULE    <span class="token operator">:=</span> hello-jni
LOCAL_SRC_FILES <span class="token operator">:=</span> hello-jni.c

<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>BUILD_SHARED_LIBRARY<span class="token punctuation">)</span>
</code></pre></div><p>如上配置示例所示，其中：</p><ol><li><p><code>LOCAL_PATH := $(call my-dir)</code></p><div class="language-text ext-text"><pre class="language-text"><code>1. Android.mk 中必须先定义 LOCAL_PATH 变量
2. 这里通过 LOCAL_PATH 变量来表示源文件在原生库项目中的位置。
   其中，my-dir 是 NDK 构建系统提供的宏函数，该函数返回当前目录的路径（即当前 Android.mk 文件所在的路径）
</code></pre></div></li><li><p><code>include $(CLEAR_VARS)</code></p><div class="language-text ext-text"><pre class="language-text"><code>1. include $(CLEAR_VARS) 表示声明 CLEAR_VARS 变量，该变量的值由 NDK 构建系统提供。
2. CLEAR_VARS 变量指向一个特殊的 GNU Makefile 脚本，这个特殊的 GNU Makefile 脚本会清除许多 LOCAL_XXX 变量，
   例如 LOCAL_MODULE、LOCAL_SRC_FILES 和 LOCAL_STATIC_LIBRARIES。
3. 注意：CLEAR_VARS 变量指向的特殊 GNU Makefile 脚本不会清除 LOCAL_PATH。
4. 如果 Android.mk 中定义了多个模块，那么在定义的每个模块之前，
   都必须先调用 include $(CLEAR_VARS) 对 CLEAR_VARS 变量进行声明。
</code></pre></div></li><li><p><code>LOCAL_MODULE := hello-jni</code></p><div class="language-text ext-text"><pre class="language-text"><code>1. 通过 LOCAL_MODULE 变量声明要构建的模块名。
   如果 Android.mk 中定义了多个模块，那么每个模块中都需要设置一次 LOCAL_MODULE 变量，为不同的模块声明不同的模块名
2. 对于用来构建共享库的模块，NDK 构建系统默认会为 LOCAL_MODULE 变量声明的模块名添加前缀 &quot;lib&quot; 和后缀 &quot;.so&quot;，
   如，会根据 LOCAL_MODULE := hello-jni 构建出共享库 libhello-jni.so 文件
   注意：如果 LOCAL_MODULE 变量声明的模块名以 &quot;lib&quot; 开头，那么构建系统就不会再添加前缀 &quot;lib&quot;
</code></pre></div></li><li><p><code>LOCAL_SRC_FILES := hello-jni.c</code></p><div class="language-text ext-text"><pre class="language-text"><code>1. 通过 LOCAL_SRC_FILES 变量声明构建所需的所有源文件。（多个源文件以空格分隔开来）
</code></pre></div></li><li><p><code>include $(BUILD_SHARED_LIBRARY)</code></p><div class="language-text ext-text"><pre class="language-text"><code>1. include $(BUILD_SHARED_LIBRARY) 表示声明 BUILD_SHARED_LIBRARY 变量，该变量的值由 NDK 构建系统提供。
2. BUILD_SHARED_LIBRARY 变量指向一个 GNU Makefile 脚本，
   该脚本会收集 include $(CLEAR_VARS) 之后的在 LOCAL_XXX 变量中声明的所有信息，
   并确定如何根据 LOCAL_SRC_FILES 变量中列出的源文件构建共享库。
</code></pre></div></li></ol><h3 id="_1-2-android-mk-中使用的变量和宏" tabindex="-1"><a class="header-anchor" href="#_1-2-android-mk-中使用的变量和宏" aria-hidden="true">#</a> 1.2 <code>Android.mk</code> 中使用的变量和宏</h3><p><code>NDK</code> 构建系统提供许多可在 <code>Android.mk</code> 文件中使用的变量。其中部分变量已预先赋值。另一些变量在 <code>Android.mk</code> 中由我们自己赋值。</p><p>除了 <code>NDK</code> 构建系统已提供的变量之外，还可以在 <code>Android.mk</code> 中自定义变量。</p><p>由于 <code>NDK</code> 构建系统保留了下列变量名称：</p><ol><li>以 <code>LOCAL_</code> 开头的名称，例如 <code>LOCAL_MODULE</code>。</li><li>以 <code>PRIVATE_</code>、<code>NDK_</code> 或 <code>APP</code> 开头的名称。构建系统在内部使用这些变量名。</li><li>小写名称，例如 <code>my-dir</code>。构建系统也是在内部使用这些变量名。</li></ol><p>所以在 <code>Android.mk</code> 中自定义变量时，建议在名称前附加 <code>MY_</code>。</p><h4 id="_1-2-1-ndk-构建系统定义的-include-相关的变量" tabindex="-1"><a class="header-anchor" href="#_1-2-1-ndk-构建系统定义的-include-相关的变量" aria-hidden="true">#</a> 1.2.1 NDK 构建系统定义的 <code>include</code> 相关的变量</h4><h5 id="_1-2-1-1-clear-vars" tabindex="-1"><a class="header-anchor" href="#_1-2-1-1-clear-vars" aria-hidden="true">#</a> 1.2.1.1 <code>CLEAR_VARS</code></h5><p>使用语法：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>CLEAR_VARS<span class="token punctuation">)</span>
</code></pre></div><div class="language-text ext-text"><pre class="language-text"><code>1. include $(CLEAR_VARS) 表示声明 CLEAR_VARS 变量，该变量的值由 NDK 构建系统提供。
2. CLEAR_VARS 变量指向一个特殊的 GNU Makefile 脚本，这个特殊的 GNU Makefile 脚本会清除许多 LOCAL_XXX 变量，
   例如 LOCAL_MODULE、LOCAL_SRC_FILES 和 LOCAL_STATIC_LIBRARIES。
3. 注意：CLEAR_VARS 变量指向的特殊 GNU Makefile 脚本不会清除 LOCAL_PATH。
4. 如果 Android.mk 中定义了多个模块，那么在定义的每个模块之前，
   都必须先调用 include $(CLEAR_VARS) 对 CLEAR_VARS 变量进行声明。
</code></pre></div><h5 id="_1-2-1-2-build-executable" tabindex="-1"><a class="header-anchor" href="#_1-2-1-2-build-executable" aria-hidden="true">#</a> 1.2.1.2 <code>BUILD_EXECUTABLE</code></h5><p>使用语法：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>BUILD_EXECUTABLE<span class="token punctuation">)</span>
</code></pre></div><div class="language-text ext-text"><pre class="language-text"><code>1. include $(BUILD_EXECUTABLE) 表示声明 BUILD_EXECUTABLE 变量，该变量的值由 NDK 构建系统提供。
2. BUILD_EXECUTABLE 变量指向一个 GNU Makefile 脚本，
   该脚本会收集 include $(CLEAR_VARS) 之后的在 LOCAL_XXX 变量中声明的所有信息，
   并确定如何根据 LOCAL_SRC_FILES 变量中列出的源文件构建可执行文件。
3. 执行 BUILD_EXECUTABLE 变量指向的 GNU Makefile 脚本之前，
   要求至少已经为 LOCAL_MODULE 和 LOCAL_SRC_FILES 变量赋值
</code></pre></div><h5 id="_1-2-1-3-build-shared-library" tabindex="-1"><a class="header-anchor" href="#_1-2-1-3-build-shared-library" aria-hidden="true">#</a> 1.2.1.3 <code>BUILD_SHARED_LIBRARY</code></h5><p>使用语法：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>BUILD_SHARED_LIBRARY<span class="token punctuation">)</span>
</code></pre></div><div class="language-text ext-text"><pre class="language-text"><code>1. include $(BUILD_SHARED_LIBRARY) 表示声明 BUILD_SHARED_LIBRARY 变量，该变量的值由 NDK 构建系统提供。
2. BUILD_SHARED_LIBRARY 变量指向一个 GNU Makefile 脚本，
   该脚本会收集 include $(CLEAR_VARS) 之后的在 LOCAL_XXX 变量中声明的所有信息，
   并确定如何根据 LOCAL_SRC_FILES 变量中列出的源文件构建共享库（即构建生成后缀为 .so 的动态库文件）。
3. 执行 BUILD_SHARED_LIBRARY 变量指向的 GNU Makefile 脚本之前，
   要求至少已经为 LOCAL_MODULE 和 LOCAL_SRC_FILES 变量赋值
4. NDK 构建系统默认会将生成的 so 动态库文件打包到 apk 文件中
</code></pre></div><h5 id="_1-2-1-4-build-static-library" tabindex="-1"><a class="header-anchor" href="#_1-2-1-4-build-static-library" aria-hidden="true">#</a> 1.2.1.4 <code>BUILD_STATIC_LIBRARY</code></h5><p>使用语法：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>BUILD_STATIC_LIBRARY<span class="token punctuation">)</span>
</code></pre></div><div class="language-text ext-text"><pre class="language-text"><code>1. include $(BUILD_STATIC_LIBRARY) 表示声明 BUILD_STATIC_LIBRARY 变量，该变量的值由 NDK 构建系统提供。
2. BUILD_STATIC_LIBRARY 变量指向一个 GNU Makefile 脚本，
   该脚本会收集 include $(CLEAR_VARS) 之后的在 LOCAL_XXX 变量中声明的所有信息，
   并确定如何根据 LOCAL_SRC_FILES 变量中列出的源文件构建静态库（即构建生产后缀为 .a 的库文件）。
3. 执行 BUILD_STATIC_LIBRARY 变量指向的 GNU Makefile 脚本之前，
   要求至少已经为 LOCAL_MODULE 和 LOCAL_SRC_FILES 变量赋值
4. NDK 构建系统不会将 .a 静态库文件打包到 apk 文件中。
   如果想让使用静态库，可以通过预构建库的方式将静态库转换成动态库。
</code></pre></div><h5 id="_1-2-1-5-prebuilt-shared-library" tabindex="-1"><a class="header-anchor" href="#_1-2-1-5-prebuilt-shared-library" aria-hidden="true">#</a> 1.2.1.5 <code>PREBUILT_SHARED_LIBRARY</code></h5><p>使用语法：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>PREBUILT_SHARED_LIBRARY<span class="token punctuation">)</span>
</code></pre></div><div class="language-text ext-text"><pre class="language-text"><code>1. PREBUILT_SHARED_LIBRARY 变量指向的 GNU Makefile 脚本用于生成预构建共享库（so 动态库）
2. 与 BUILD_SHARED_LIBRARY 不同的是，PREBUILT_SHARED_LIBRARY 指向的 GNU Makefile 脚本所收集的 
   LOCAL_SRC_FILES 变量中的信息不能是源文件，而必须是指向预构建共享库的单一路径，如 foo/libfoo.so

注意：对于第三方提供的共享库，应该先将其路径赋给 LOCAL_SRC_FILES 变量，
      然后通过 include $(PREBUILT_SHARED_LIBRARY) 封装成预构建共享库模块，
      最后在依赖第三方共享库的其他模块中，将第三方共享库对于的预构建共享库模块的名称赋给 LOCAL_SHARED_LIBRARIES 变量。
</code></pre></div><h5 id="_1-2-1-6-prebuilt-static-library" tabindex="-1"><a class="header-anchor" href="#_1-2-1-6-prebuilt-static-library" aria-hidden="true">#</a> 1.2.1.6 <code>PREBUILT_STATIC_LIBRARY</code></h5><p>使用语法：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>PREBUILT_STATIC_LIBRARY<span class="token punctuation">)</span>
</code></pre></div><div class="language-text ext-text"><pre class="language-text"><code>1. PREBUILT_STATIC_LIBRARY 变量指向的 GNU Makefile 脚本用于生成预构建静态库
2. 与 BUILD_STATIC_LIBRARY 不同的是，PREBUILT_STATIC_LIBRARY 指向的 GNU Makefile 脚本所收集的 
   LOCAL_SRC_FILES 变量中的信息不能是源文件，而必须是指向预构建静态库的单一路径，如 foo/libfoo.a

注意：对于第三方提供的静态库，应该先将其路径赋给 LOCAL_SRC_FILES 变量，
      然后通过 include $(PREBUILT_STATIC_LIBRARY) 封装成预构建静态库模块，
      最后在依赖第三方静态库的其他模块中，将第三方静态库对于的预构建静态库模块的名称赋给 LOCAL_STATIC_LIBRARIES 变量。
</code></pre></div><h4 id="_1-2-2-ndk-构建系统定义的模块构建产物相关的变量" tabindex="-1"><a class="header-anchor" href="#_1-2-2-ndk-构建系统定义的模块构建产物相关的变量" aria-hidden="true">#</a> 1.2.2 <code>NDK</code> 构建系统定义的模块构建产物相关的变量</h4><h5 id="_1-2-2-1-cpu-架构-abi" tabindex="-1"><a class="header-anchor" href="#_1-2-2-1-cpu-架构-abi" aria-hidden="true">#</a> 1.2.2.1 <code>CPU</code> 架构 &amp; <code>ABI</code></h5><p>不同的 <code>Android</code> 设备可能采用不同的 <code>CPU</code> 架构。不同的 <code>CPU</code> 架构支持不同的指令集。不同的指令集对应不同的 <code>ABI</code>（<code>Application Binary Interface</code>，应用程序二进制接口）。</p><p>也就是说，若 <code>CPU</code> 架构不同，则 <code>ABI</code> 不同。于是，<strong>我们通常用 <code>ABI</code> 表示不同的 <code>CPU</code> 架构</strong>。</p><p>常见的 <code>CPU</code> 架构和 <code>ABI</code> 的对应关系如下：</p><table><thead><tr><th style="text-align:left;"><code>CPU</code> 架构</th><th style="text-align:left;"><code>ABI</code></th></tr></thead><tbody><tr><td style="text-align:left;"><code>ARMv5</code></td><td style="text-align:left;"><code>armeabi</code></td></tr><tr><td style="text-align:left;"><code>ARMv7</code></td><td style="text-align:left;"><code>armeabi-v7a</code></td></tr><tr><td style="text-align:left;"><code>ARMv8 AArch64</code></td><td style="text-align:left;"><code>arm64-v8a</code></td></tr><tr><td style="text-align:left;"><code>i686</code></td><td style="text-align:left;"><code>x86</code></td></tr><tr><td style="text-align:left;"><code>x86-64</code></td><td style="text-align:left;"><code>x86_64</code></td></tr></tbody></table><blockquote><p>其中：</p><ol><li><code>ARMv5</code> 是 <code>32</code> 位的 <code>ARM</code> 架构</li><li><code>ARMv7</code> 是 <code>32</code> 位的 <code>ARM</code> 架构</li><li><code>ARMv8</code> 是 <code>64</code> 位的 <code>ARM</code> 架构</li><li><code>i686</code> 是 <code>32</code> 位的 <code>x86</code> 架构</li><li><code>x86-64</code> 是 <code>64</code> 位的 <code>x86</code> 架构</li></ol><p>注意：</p><ol><li><code>armeabi</code> 和 <code>armeabi-v7a</code> 都是 <code>32</code> 位 <code>ARM</code> 架构下的 <code>ABI</code>。其中 <code>armeabi</code> 是相当老旧的一个版本，缺少对浮点数计算的硬件支持，在需要大量计算时有性能瓶颈。<code>armeabi-v7a</code> 是替代 <code>armeabi</code> 的主流版本。且 <code>armeabi-v7a</code> 向下兼容 <code>armeabi</code>。</li><li><code>arm64-v8a</code> 是 <code>64</code> 位 <code>ARM</code> 架构下的 <code>ABI</code>。且 <code>arm64-v8a</code> 向下兼容 <code>armeabi-v7a</code> 和 <code>armeabi</code>。</li></ol></blockquote><p>在 <code>Application.mk</code> 文件中，可以通过 <code>APP_ABI</code> 变量声明 <code>Android.mk</code> 中所定义模块的构建产物支持的 <code>ABI</code>（即 <code>CPU</code> 架构）。</p><p>通过 <code>APP_ABI</code> 变量可以同时声明多个支持的 <code>ABI</code>，此时针对每个 <code>ABI</code> 都会对 <code>Android.mk</code> 文件解析一次，且每次解析时 <code>Android.mk</code> 文件中跟模块构建产物相关的变量的取值都不相同。</p><h5 id="_1-2-2-2-target-arch" tabindex="-1"><a class="header-anchor" href="#_1-2-2-2-target-arch" aria-hidden="true">#</a> 1.2.2.2 <code>TARGET_ARCH</code></h5><div class="language-text ext-text"><pre class="language-text"><code>TARGET_ARCH 变量用来表示不同的 CPU 系列。取值可以是：arm、arm64、x86 或 x86_64
（不同的 ABI 对应不同的 CPU 架构，不同的 CPU 架构可能属于不同的 CPU 系列）
在每次解析 Android.mk 文件时，NDK 构建系统会根据 ABI 的不同为 TARGET_ARCH 变量设置不同的值。
</code></pre></div><p><code>CPU</code> 架构、<code>ABI</code>、<code>CPU</code> 系列的对应关系如下（个人理解，可能有误）：</p><table><thead><tr><th style="text-align:left;"><code>CPU</code> 架构</th><th style="text-align:left;"><code>ABI</code></th><th style="text-align:left;"><code>CPU</code> 系列</th></tr></thead><tbody><tr><td style="text-align:left;"><code>ARMv5</code></td><td style="text-align:left;"><code>armeabi</code></td><td style="text-align:left;"><code>arm</code></td></tr><tr><td style="text-align:left;"><code>ARMv7</code></td><td style="text-align:left;"><code>armeabi-v7a</code></td><td style="text-align:left;"><code>arm</code></td></tr><tr><td style="text-align:left;"><code>ARMv8 AArch64</code></td><td style="text-align:left;"><code>arm64-v8a</code></td><td style="text-align:left;"><code>arm64</code></td></tr><tr><td style="text-align:left;"><code>i686</code></td><td style="text-align:left;"><code>x86</code></td><td style="text-align:left;"><code>x86</code></td></tr><tr><td style="text-align:left;"><code>x86-64</code></td><td style="text-align:left;"><code>x86_64</code></td><td style="text-align:left;"><code>x86_64</code></td></tr></tbody></table><h5 id="_1-2-2-3-target-platform" tabindex="-1"><a class="header-anchor" href="#_1-2-2-3-target-platform" aria-hidden="true">#</a> 1.2.2.3 <code>TARGET_PLATFORM</code></h5><div class="language-text ext-text"><pre class="language-text"><code>TARGET_PLATFORM 变量用来表示不同的 Android 版本号。取值为 &quot;android-&lt;API Level&gt;&quot;
如，Android 5.1 系统版本 的 API Level 为 22，于是 TARGET_PLATFORM 变量取值为 android-22
</code></pre></div><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">ifeq</span> <span class="token punctuation">(</span><span class="token variable">$</span><span class="token punctuation">(</span>TARGET_PLATFORM<span class="token punctuation">)</span>, android-22<span class="token punctuation">)</span>
    <span class="token comment"># ... do something ...</span>
<span class="token keyword">endif</span>
</code></pre></div><h5 id="_1-2-2-4-target-arch-abi" tabindex="-1"><a class="header-anchor" href="#_1-2-2-4-target-arch-abi" aria-hidden="true">#</a> 1.2.2.4 <code>TARGET_ARCH_ABI</code></h5><div class="language-text ext-text"><pre class="language-text"><code>TARGET_ARCH_ABI 变量用来表示不同的 ABI。取值为：armeabi、armeabi-v7a、arm64-v8a、x86、x86_64
在每次解析 Android.mk 文件时，NDK 构建系统会根据 ABI 的不同为 TARGET_ARCH_ABI 变量设置不同的值。
</code></pre></div><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">ifeq</span> <span class="token punctuation">(</span><span class="token variable">$</span><span class="token punctuation">(</span>TARGET_ARCH_ABI<span class="token punctuation">)</span>,arm64-v8a<span class="token punctuation">)</span>
  <span class="token comment"># ... do something ...</span>
<span class="token keyword">endif</span>
</code></pre></div><h5 id="_1-2-2-5-target-abi" tabindex="-1"><a class="header-anchor" href="#_1-2-2-5-target-abi" aria-hidden="true">#</a> 1.2.2.5 <code>TARGET_ABI</code></h5><div class="language-text ext-text"><pre class="language-text"><code>TARGET_ABI 变量的取值是 TARGET_PLATFORM 和 TARGET_ARCH_ABI 变量值的组合，
即 TARGET_ABI 变量用来表示当前解析 Android.mk 时使用的 Android 系统版本和 ABI
</code></pre></div><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">ifeq</span> <span class="token punctuation">(</span><span class="token variable">$</span><span class="token punctuation">(</span>TARGET_ABI<span class="token punctuation">)</span>,android-22-arm64-v8a<span class="token punctuation">)</span>
  <span class="token comment"># ... do something ...</span>
<span class="token keyword">endif</span>
</code></pre></div><h4 id="_1-2-3-ndk-构建系统定义的描述模块的变量" tabindex="-1"><a class="header-anchor" href="#_1-2-3-ndk-构建系统定义的描述模块的变量" aria-hidden="true">#</a> 1.2.3 <code>NDK</code> 构建系统定义的描述模块的变量</h4><h5 id="_1-2-3-1-android-mk-中描述-定义-模块的基本流程" tabindex="-1"><a class="header-anchor" href="#_1-2-3-1-android-mk-中描述-定义-模块的基本流程" aria-hidden="true">#</a> 1.2.3.1 <code>Android.mk</code> 中描述（定义）模块的基本流程</h5><p><code>Android.mk</code> 中可以定义多个模块，每个模块在定义时的描述流程如下：</p><ol><li><p>先调用 <code>include $(CLEAR_VARS)</code> 初始化描述模块的变量（即清除掉描述模块的变量中已存储的值）</p><blockquote><p>注意：<code>include $(CLEAR_VARS)</code> 不会清除掉 <code>LOCAL_PATH</code> 变量值。</p></blockquote></li><li><p>为形如<code> LOCAL_XXX</code> 这样的用于描述模块的多个变量赋值，以实现对所定义模块的描述。</p></li><li><p>调用形如 <code>include $(BUILD_XXX)</code> 或 <code>include $(PREBUILT_XXX)</code> 所指向的 <code>GUN makefile</code> 脚本对所定义的模块进行构建。</p></li></ol><h5 id="_1-2-3-2-local-path" tabindex="-1"><a class="header-anchor" href="#_1-2-3-2-local-path" aria-hidden="true">#</a> 1.2.3.2 <code>LOCAL_PATH</code></h5><p>此变量用于指定当前文件的路径。必须在 <code>Android.mk</code> 文件开头定义此变量。以下示例演示了如何定义此变量：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> my-dir<span class="token punctuation">)</span>
</code></pre></div><p><code>CLEAR_VARS</code> 所指向的脚本不会清除此变量。因此，即使 <code>Android.mk</code> 文件描述了多个模块，您也只需定义此变量一次。</p><h5 id="_1-2-3-3-local-module" tabindex="-1"><a class="header-anchor" href="#_1-2-3-3-local-module" aria-hidden="true">#</a> 1.2.3.3 <code>LOCAL_MODULE</code></h5><p>此变量用于存储模块名称。指定的名称在所有模块名称中必须唯一，并且不得包含任何空格。</p><p>您必须先定义该名称，然后才能添加任何脚本（<code>CLEAR_VARS</code> 的脚本除外）。</p><p>无需添加 <code>lib</code> 前缀或 <code>.so</code> 或 <code>.a</code> 文件扩展名；构建系统会自动执行这些修改。</p><p>例如，以下行会导致生成名为 <code>libfoo.so</code> 的共享库模块：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>LOCAL_MODULE <span class="token operator">:=</span> <span class="token string">&quot;foo&quot;</span>
</code></pre></div><p>如果不想让模块构建的库文件以 <code>lib&lt;Module_Name&gt;</code> 命名，则可以使用 <code>LOCAL_MODULE_FILENAME</code> 变量指定其他的库文件名。</p><h5 id="_1-2-3-4-local-module-filename" tabindex="-1"><a class="header-anchor" href="#_1-2-3-4-local-module-filename" aria-hidden="true">#</a> 1.2.3.4 <code>LOCAL_MODULE_FILENAME</code></h5><p><code>LOCAL_MODULE_FILENAME</code> 为可选变量，显示指定模块构建生成的库文件名。</p><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 此时，模块构建生成的库文件名不是 libfoo.so，而是 libnewfoo.so</span>
LOCAL_MODULE <span class="token operator">:=</span> foo
LOCAL_MODULE_FILENAME <span class="token operator">:=</span> libnewfoo
...
<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>BUILD_SHARED_LIBRARY<span class="token punctuation">)</span>
</code></pre></div><blockquote><p>注意：<code>LOCAL_MODULE_FILENAME</code> 变量无法指定库文件名的后缀，以及库文件的生成路径</p></blockquote><h5 id="_1-2-3-5-local-src-files" tabindex="-1"><a class="header-anchor" href="#_1-2-3-5-local-src-files" aria-hidden="true">#</a> 1.2.3.5 <code>LOCAL_SRC_FILES</code></h5><p>指定构建模块时所需的所有源文件。</p><p>只需要列出构建系统实际传递到编译器的文件，因为构建系统会自动计算所有相关的依赖项。</p><p>注意：可以使用相对（相对于 <code>LOCAL_PATH</code>）和绝对文件路径。</p><h5 id="_1-2-3-6-local-cpp-extension" tabindex="-1"><a class="header-anchor" href="#_1-2-3-6-local-cpp-extension" aria-hidden="true">#</a> 1.2.3.6 <code>LOCAL_CPP_EXTENSION</code></h5><p>可选变量，用于指定可识别的 <code>C++</code> 源文件的后缀名。</p><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 构建系统只能识别后缀为 &quot;.cxx&quot; 的 C++ 源文件</span>
LOCAL_CPP_EXTENSION <span class="token operator">:=</span> .cxx
</code></pre></div><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 构建系统只能识别后缀为 &quot;.cxx&quot;、&quot;.cpp&quot;、&quot;.cc&quot; 的 C++ 源文件</span>
LOCAL_CPP_EXTENSION <span class="token operator">:=</span> .cxx .cpp .cc
</code></pre></div><h5 id="_1-2-3-7-local-cpp-features" tabindex="-1"><a class="header-anchor" href="#_1-2-3-7-local-cpp-features" aria-hidden="true">#</a> 1.2.3.7 <code>LOCAL_CPP_FEATURES</code></h5><p>指定构建模块时所支持的 <code>C++</code> 功能特征</p><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 指定 C++ 源代码中支持使用 RTTI（运行时类型信息）</span>
LOCAL_CPP_FEATURES <span class="token operator">:=</span> rtti
</code></pre></div><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 指定 C++ 源代码中支持使用 C++ 异常</span>
LOCAL_CPP_FEATURES <span class="token operator">:=</span> exceptions
</code></pre></div><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 同时指定多个 C++ 功能特征时，用空格分隔</span>
LOCAL_CPP_FEATURES <span class="token operator">:=</span> rtti exceptions
</code></pre></div><blockquote><p>注意：通过在 <code>LOCAL_CPPFLAGS</code> 变量中设置 <code>-frtti</code> 和 <code>-fexceptions</code> 也可以达到同样的效果。区别是：</p><ol><li><code>LOCAL_CPP_FEATURES</code> 变量可让构建系统对每个模块使用适当的标记。</li><li><code>LOCAL_CPPFLAGS</code> 变量会导致编译器将所有指定的标记用于所有模块，而不管实际需求如何。</li></ol></blockquote><h5 id="_1-2-3-8-local-c-includes" tabindex="-1"><a class="header-anchor" href="#_1-2-3-8-local-c-includes" aria-hidden="true">#</a> 1.2.3.8 <code>LOCAL_C_INCLUDES</code></h5><p>您可使用此可选变量指定相对于 <code>NDK root</code> 目录的路径列表，以便在编译所有源文件（<code>C</code>、<code>C++</code> 和 <code>Assembly</code>）时添加到 <code>include</code> 搜索路径中。</p><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 相对于 NDK root 目录的路径列表</span>
LOCAL_C_INCLUDES <span class="token operator">:=</span> sources/foo
</code></pre></div><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 相对于当前 Android.mk 文件所在目录的路径列表</span>
LOCAL_C_INCLUDES <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span>/&lt;subdirectory&gt;/foo
</code></pre></div><blockquote><p>注意：</p><ol><li>如果另外还通过了 <code>LOCAL_CFLAGS</code> 或 <code>LOCAL_CPPFLAGS</code> 变量设置了 <code>include</code> 搜素路径（<code>-I&lt;path&gt;</code>），那么应该在设置 <code>LOCAL_CFLAGS</code> 或 <code>LOCAL_CPPFLAGS</code> 变量之前，先设置 <code>LOCAL_C_INCLUDES</code> 变量。</li><li>在使用 <code>ndk-gdb</code> 启动原生调试时，构建系统也会自动使用 <code>LOCAL_C_INCLUDES</code> 路径。</li></ol></blockquote><h5 id="_1-2-3-9-local-cflags" tabindex="-1"><a class="header-anchor" href="#_1-2-3-9-local-cflags" aria-hidden="true">#</a> 1.2.3.9 <code>LOCAL_CFLAGS</code></h5><p>此可选变量用于设置在构建 <code>C</code> 和 <code>C++</code> 源文件时构建系统要传递的编译器标记。</p><p>这样，您就可以指定额外的宏定义或编译选项。</p><blockquote><p>可以使用 <code>LOCAL_CPPFLAGS</code> 仅为 <code>C++</code> 指定标记。</p></blockquote><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 指定额外的 include 路径，</span>
<span class="token comment"># 但最好使用 LOCAL_C_INCLUDES，因为 LOCAL_C_INCLUDES 指定的 include 路径还可用于 ndk-gdb 原生调试</span>
LOCAL_CFLAGS <span class="token operator">+=</span> -I&lt;path&gt;,
</code></pre></div><h5 id="_1-2-3-10-local-cppflags" tabindex="-1"><a class="header-anchor" href="#_1-2-3-10-local-cppflags" aria-hidden="true">#</a> 1.2.3.10 <code>LOCAL_CPPFLAGS</code></h5><p>只构建 <code>C++</code> 源文件时将传递的一组可选编译器标记。</p><p><code>LOCAL_CPPFLAGS</code> 设置的标记出现在编译器命令行中的 <code>LOCAL_CFLAGS</code> 后面。</p><blockquote><p>注意：如果要同时为 <code>C</code> 和 <code>C++</code> 指定标记，那么使用 <code>LOCAL_CFLAGS</code> 。</p></blockquote><h5 id="_1-2-3-11-local-static-libraries" tabindex="-1"><a class="header-anchor" href="#_1-2-3-11-local-static-libraries" aria-hidden="true">#</a> 1.2.3.11 <code>LOCAL_STATIC_LIBRARIES</code></h5><p>指定构建当前模块时所依赖的静态库模块列表。</p><p>如果当前模块是共享库或可执行文件，此变量将强制这些库链接到生成的二进制文件。</p><p>如果当前模块是静态库，此变量只是指出依赖于当前模块的其他模块也会依赖于列出的库。</p><h5 id="_1-2-3-12-local-shared-libraries" tabindex="-1"><a class="header-anchor" href="#_1-2-3-12-local-shared-libraries" aria-hidden="true">#</a> 1.2.3.12 <code>LOCAL_SHARED_LIBRARIES</code></h5><p>指定构建当前模块时所依赖的共享库模块列表。</p><p>此变量将强制这些库链接到生成的二进制文件。</p><h5 id="_1-2-3-13-local-whole-static-libraries" tabindex="-1"><a class="header-anchor" href="#_1-2-3-13-local-whole-static-libraries" aria-hidden="true">#</a> 1.2.3.13 <code>LOCAL_WHOLE_STATIC_LIBRARIES</code></h5><p>此变量是 <code>LOCAL_STATIC_LIBRARIES</code> 的变体，表示链接器应将相关的库模块视为完整归档。</p><blockquote><p>如需详细了解完整归档，请参阅有关 <code>--whole-archive</code> 标记的 <a href="http://ftp.gnu.org/old-gnu/Manuals/ld-2.9.1/html_node/ld_3.html" target="_blank" rel="noopener noreferrer">GNU Id 文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>多个静态库之间存在循环依赖关系时，此变量十分有用。</p><p>使用此变量构建共享库文件时，它将强制构建系统将静态库中的所有对象文件添加到最终二进制文件。</p><p>但是，使用此变量构建可执行文件时不会发生这种情况。</p><h5 id="_1-2-3-14-local-ldlibs" tabindex="-1"><a class="header-anchor" href="#_1-2-3-14-local-ldlibs" aria-hidden="true">#</a> 1.2.3.14 <code>LOCAL_LDLIBS</code></h5><p>此变量列出了在构建共享库或可执行文件时使用的额外链接器标记。</p><p>利用此变量，您可使用 <code>-l</code> 前缀传递特定系统库的名称。</p><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 在构建当前模块的加载过程中，指示链接器链接到 /system/lib/libz.so 库。</span>
LOCAL_LDLIBS <span class="token operator">:=</span> -lz
</code></pre></div><blockquote><p>如需查看可以链接的公开系统库列表，请参阅 <a href="https://developer.android.google.cn/ndk/guides/stable_apis?hl=zh-cn" target="_blank" rel="noopener noreferrer">原生 API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p></blockquote><blockquote><p>注意：如果当前构建的模块用于生成静态库，那么构建系统会忽略此变量，并且 <code>ndk-build</code> 显示一则警告。</p></blockquote><h5 id="_1-2-3-15-local-ldflags" tabindex="-1"><a class="header-anchor" href="#_1-2-3-15-local-ldflags" aria-hidden="true">#</a> 1.2.3.15 <code>LOCAL_LDFLAGS</code></h5><p>此变量列出了构建系统在构建共享库或可执行文件时使用的其他链接器标记。</p><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token comment"># 若要在 ARM/X86 上使用 ld.bfd 链接器，则需配置以下链接器标记</span>
LOCAL_LDFLAGS <span class="token operator">+=</span> -fuse-ld<span class="token operator">=</span>bfd
</code></pre></div><blockquote><p>注意：如果当前构建的模块用于生成静态库，那么构建系统会忽略此变量，并且 <code>ndk-build</code> 显示一则警告。</p></blockquote><h5 id="_1-2-3-16-local-allow-undefined-symbols" tabindex="-1"><a class="header-anchor" href="#_1-2-3-16-local-allow-undefined-symbols" aria-hidden="true">#</a> 1.2.3.16 <code>LOCAL_ALLOW_UNDEFINED_SYMBOLS</code></h5><p>默认情况下，如果构建系统在尝试构建共享库时遇到未定义的引用，将会抛出 “未定义的符号” 错误。</p><blockquote><p>根据抛出 “未定义的符号” 错误可帮助您捕获源代码中的错误。</p></blockquote><p>如需停用此检查（即不抛出 “未定义的符号” 错误），请将 <code>LOCAL_ALLOW_UNDEFINED_SYMBOLS</code> 变量设置为 <code>true</code>。</p><blockquote><p>请注意，将 <code>LOCAL_ALLOW_UNDEFINED_SYMBOLS</code> 变量设置为 <code>true</code> 可能会导致共享库在运行时加载。</p></blockquote><blockquote><p>注意：如果当前构建的模块用于生成静态库，那么构建系统会忽略此变量，并且 <code>ndk-build</code> 显示一则警告。</p></blockquote><h5 id="_1-2-3-17-local-arm-mode" tabindex="-1"><a class="header-anchor" href="#_1-2-3-17-local-arm-mode" aria-hidden="true">#</a> 1.2.3.17 <code>LOCAL_ARM_MODE</code></h5><p>默认情况下，构建系统会以 <code>thumb</code> 模式生成 <code>ARM</code> 目标二进制文件，其中每条指令都是 <code>16</code> 位宽，并与 <code>thumb/</code> 目录中的 <code>STL</code> 库链接。</p><p>将此变量定义为 <code>arm</code> 会强制构建系统以 <code>32</code> 位 <code>arm</code> 模式生成模块的对象文件。以下示例演示了如何执行此操作：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>LOCAL_ARM_MODE <span class="token operator">:=</span> arm
</code></pre></div><p>您也可以对源文件名附加 <code>.arm</code> 后缀，指示构建系统仅以 <code>arm</code> 模式构建特定的源文件。例如，以下示例指示构建系统始终以 <code>ARM</code> 模式编译 <code>bar.c</code>，但根据 <code>LOCAL_ARM_MODE</code> 的值构建 <code>foo.c</code>。</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>LOCAL_SRC_FILES <span class="token operator">:=</span> foo.c bar.c.arm
</code></pre></div><blockquote><p>注意：</p><p>您也可以在 <code>Application.mk</code> 文件中将 <code>APP_OPTIM</code> 设置为 <code>debug</code>，强制构建系统生成 <code>ARM</code> 二进制文件。</p><p>指定 <code>debug</code> 会强制构建 <code>ARM</code>，因为工具链调试程序无法正确处理 <code>Thumb</code> 代码。</p></blockquote><h5 id="_1-2-3-18-local-arm-neon" tabindex="-1"><a class="header-anchor" href="#_1-2-3-18-local-arm-neon" aria-hidden="true">#</a> 1.2.3.18 <code>LOCAL_ARM_NEON</code></h5><p>此变量仅在以 <code>armeabi-v7a</code> <code>ABI</code> 为目标时才有意义。它允许在 <code>C</code> 和 <code>C++</code> 源文件中使用 <code>ARM Advanced SIMD (NEON)</code> 编译器内建函数，以及在 <code>Assembly</code> 文件中使用 <code>NEON</code> 指令。</p><blockquote><p>请注意，并非所有基于 <code>ARMv7</code> 的 <code>CPU</code> 都支持 <code>NEON</code> 扩展指令集。因此，必须执行运行时检测，以便在运行时安全地使用此代码。如需了解详情，请参阅 <a href="https://developer.android.google.cn/ndk/guides/cpu-arm-neon?hl=zh-cn" target="_blank" rel="noopener noreferrer">Neon 支持<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 和 <a href="https://developer.android.google.cn/ndk/guides/cpu-features?hl=zh-cn" target="_blank" rel="noopener noreferrer">CPU 功能<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p></blockquote><p>此外，您也可以使用 <code>.neon</code> 后缀，指定构建系统仅以 <code>NEON</code> 支持来编译特定源文件。在以下示例中，构建系统以 <code>Thumb</code> 和 <code>NEON</code> 支持编译 <code>foo.c</code>，以 <code>Thumb</code> 支持编译 <code>bar.c</code>，并以 <code>ARM</code> 和 <code>NEON</code> 支持编译 <code>zoo.c</code>：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>LOCAL_SRC_FILES <span class="token operator">=</span> foo.c.neon bar.c zoo.c.arm.neon
</code></pre></div><blockquote><p>如果同时使用这两个后缀，<code>.arm</code> 必须在 <code>.neon</code> 前面。</p></blockquote><h5 id="_1-2-3-19-local-disable-format-string-checks" tabindex="-1"><a class="header-anchor" href="#_1-2-3-19-local-disable-format-string-checks" aria-hidden="true">#</a> 1.2.3.19 <code>LOCAL_DISABLE_FORMAT_STRING_CHECKS</code></h5><p>默认情况下，构建系统会在编译代码时保护格式字符串。这样的话，如果 <code>printf</code> 样式的函数中使用了非常量格式的字符串，就会强制引发编译器错误。</p><p>此保护默认启用，但您也可通过将此变量的值设置为 <code>true</code> 将其停用。（如果没有必要的原因，我们不建议停用）</p><h5 id="_1-2-3-20-local-export-cflags" tabindex="-1"><a class="header-anchor" href="#_1-2-3-20-local-export-cflags" aria-hidden="true">#</a> 1.2.3.20 <code>LOCAL_EXPORT_CFLAGS</code></h5><p>在一个模块中使用此变量来记录一组 <code>C/C++</code> 编译器标记，这些标记将被添加到通过 <code>LOCAL_STATIC_LIBRARIES</code> 或 <code>LOCAL_SHARED_LIBRARIES</code> 变量依赖这个模块的其他模块的 <code>LOCAL_CFLAGS</code> 变量中。</p><p>示例：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>CLEAR_VARS<span class="token punctuation">)</span>
LOCAL_MODULE <span class="token operator">:=</span> foo
LOCAL_SRC_FILES <span class="token operator">:=</span> foo/foo.c
LOCAL_EXPORT_CFLAGS <span class="token operator">:=</span> -DFOO<span class="token operator">=</span>1
<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>BUILD_STATIC_LIBRARY<span class="token punctuation">)</span>

<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>CLEAR_VARS<span class="token punctuation">)</span>
LOCAL_MODULE <span class="token operator">:=</span> bar
LOCAL_SRC_FILES <span class="token operator">:=</span> bar.c
LOCAL_CFLAGS <span class="token operator">:=</span> -DBAR<span class="token operator">=</span>2
LOCAL_STATIC_LIBRARIES <span class="token operator">:=</span> foo
<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>BUILD_SHARED_LIBRARY<span class="token punctuation">)</span>
</code></pre></div><p>以上示例中，模块 <code>bar</code> 通过 <code>LOCAL_STATIC_LIBRARIES</code> 变量依赖了模块 <code>foo</code>，于是模块 <code>foo</code> 中通过 <code>LOCAL_EXPORT_CFLAGS</code> 变量记录的编译器标记 <code>-DFOO=1</code> 会被添加到模块 <code>bar</code> 的 <code>LOCAL_CFLAGS</code> 变量中。最终，在构建模块 <code>bar</code> 时会向编译器传递 <code>2</code> 个标记，即：<code>-DBAR=2</code> 和 <code>-DFOO=1</code>。</p><p>注意：</p><ol><li><p>在构建模块 <code>foo</code> 时（即在执行局部构建时），不会向编译器传递 <code>LOCAL_EXPORT_CFLAGS</code> 变量中设置的标记。</p><blockquote><p>如果想在构建模块 <code>foo</code> 时向编译器传递 <code>-DFOO=1</code> 标记，那么需要在模块 <code>foo</code> 中通过 <code>LOCAL_CFLAGS</code> 变量设置此标记。</p></blockquote></li><li><p><code>LOCAL_EXPORT_CFLAGS</code> 变量导出的编译器标记具有传递性，即：如果模块 <code>other</code> 依赖了模块 <code>bar</code>，模块 <code>bar</code> 依赖了模块 <code>foo</code>，那么在模块 <code>foo</code> 中通过 <code>LOCAL_EXPORT_CFLAGS</code> 变量导出的标记，也会添加到模块 <code>other</code> 的 <code>LOCAL_CFLAGS</code> 变量中。</p></li></ol><h5 id="_1-2-3-21-local-export-cppflags" tabindex="-1"><a class="header-anchor" href="#_1-2-3-21-local-export-cppflags" aria-hidden="true">#</a> 1.2.3.21 <code>LOCAL_EXPORT_CPPFLAGS</code></h5><p>此变量与 <code>LOCAL_EXPORT_CFLAGS</code> 类似，但仅适用于 <code>C++</code> 标记。</p><h5 id="_1-2-3-22-local-export-c-includes" tabindex="-1"><a class="header-anchor" href="#_1-2-3-22-local-export-c-includes" aria-hidden="true">#</a> 1.2.3.22 <code>LOCAL_EXPORT_C_INCLUDES</code></h5><p>此变量与 <code>LOCAL_EXPORT_CFLAGS</code> 类似，但适用于 <code>C include</code> 路径。</p><p>例如，当 <code>bar.c</code> 需要包括模块 <code>foo</code> 的头文件时，此变量很有用。</p><h5 id="_1-2-3-23-local-export-ldflags" tabindex="-1"><a class="header-anchor" href="#_1-2-3-23-local-export-ldflags" aria-hidden="true">#</a> 1.2.3.23 <code>LOCAL_EXPORT_LDFLAGS</code></h5><p>此变量与 <code>LOCAL_EXPORT_CFLAGS</code> 类似，但适用于链接器标记。</p><h5 id="_1-2-3-24-local-export-ldlibs" tabindex="-1"><a class="header-anchor" href="#_1-2-3-24-local-export-ldlibs" aria-hidden="true">#</a> 1.2.3.24 <code>LOCAL_EXPORT_LDLIBS</code></h5><p>此变量与 <code>LOCAL_EXPORT_CFLAGS</code> 类似，用于指示构建系统将特定系统库的名称传递到编译器。</p><blockquote><p>请在您指定的每个库名称前附加 <code>-l</code>。</p></blockquote><h5 id="_1-2-3-25-local-short-commands" tabindex="-1"><a class="header-anchor" href="#_1-2-3-25-local-short-commands" aria-hidden="true">#</a> 1.2.3.25 <code>LOCAL_SHORT_COMMANDS</code></h5><p>当您的模块有很多源文件和/或依赖的静态或共享库时，请将此变量设置为 <code>true</code>。这样会强制构建系统将 ``@ 语法用于包含中间对象文件或链接库的归档。</p><p>此功能在 <code>Windows</code> 上可能很有用，在 <code>Windows</code> 上，命令行最多只接受 <code>8191</code> 个字符，这对于复杂的项目来说可能太少。它还会影响个别源文件的编译，而且将几乎所有编译器标记都放在列表文件内。</p><p>也可以在 <code>Application.mk</code> 文件中定义 <code>APP_SHORT_COMMANDS</code>，对项目中的所有模块强制实施此行为。</p><p>我们不建议默认启用此功能，因为它会减慢构建速度。</p><h5 id="_1-2-3-26-local-thin-archive" tabindex="-1"><a class="header-anchor" href="#_1-2-3-26-local-thin-archive" aria-hidden="true">#</a> 1.2.3.26 <code>LOCAL_THIN_ARCHIVE</code></h5><p>构建静态库时，请将此变量设置为 <code>true</code>。这样会生成一个瘦归档，即一个库文件，其中不含对象文件，而只包含它通常包含的实际对象的文件路径。</p><p>这对于减小构建输出的大小非常有用。但缺点是，这样的库无法移至其他位置（其中的所有路径都是相对路径）。</p><p>有效值为 <code>true</code>、<code>false</code> 或空白。您可在 <code>Application.mk</code> 文件中通过 <code>APP_THIN_ARCHIVE</code> 变量来设置默认值。</p><blockquote><p>注意：在非静态库模块或预构建的静态库模块中，将会忽略此变量。</p></blockquote><h5 id="_1-2-3-27-local-filter-asm" tabindex="-1"><a class="header-anchor" href="#_1-2-3-27-local-filter-asm" aria-hidden="true">#</a> 1.2.3.27 <code>LOCAL_FILTER_ASM</code></h5><h3 id="_1-3-预构建库" tabindex="-1"><a class="header-anchor" href="#_1-3-预构建库" aria-hidden="true">#</a> 1.3 预构建库</h3><blockquote><p>参考：<a href="https://developer.android.google.cn/ndk/guides/prebuilts?hl=zh-cn" target="_blank" rel="noopener noreferrer">使用预构建库<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>预构建库就是指为了将第三方静态库文件或共享库文件添加到使用这些库文件的其他模块中，而将这些第三方库文件预先声明在某模块中，这个用于声明第三方库文件的模块就是预构建库模块。</p><p>使用预构建库的流程如下：</p><ol><li><p>声明预构建库模块</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> my-dir<span class="token punctuation">)</span>

<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>CLEAR_VARS<span class="token punctuation">)</span>
LOCAL_MODULE <span class="token operator">:=</span> foo-prebuilt
LOCAL_SRC_FILES <span class="token operator">:=</span> libfoo.so
<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>PREBUILT_SHARED_LIBRARY<span class="token punctuation">)</span>
</code></pre></div><div class="language-text ext-text"><pre class="language-text"><code>注意：
1. 通过 LOCAL_SRC_FILES 变量引入第三方库文件路径。
   （库文件路径可以是相对于 LOCAL_PATH 的相对路径，即当前 Android.mk 所在目录的相对路径）
2. 第三方库文件所支持的 CPU 平台架构，必须跟使用这些库文件的其他模块所生成的构建产物的 CPU 平台架构相同。
3. 如果第三方库文件是静态库文件，那么通过 PREBUILT_STATIC_LIBRARY 声明预构建库模块；
   如果第三方库文件是共享库文件，那么通过 PREBUILT_SHARED_LIBRARY 声明预构建库模块
</code></pre></div></li><li><p>将预构建库模块引入到使用预构建库的其他模块中</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>CLEAR_VARS<span class="token punctuation">)</span>
LOCAL_MODULE <span class="token operator">:=</span> foo-user
LOCAL_SRC_FILES <span class="token operator">:=</span> foo-user.c
LOCAL_SHARED_LIBRARIES <span class="token operator">:=</span> foo-prebuilt <span class="token comment"># 引入第三方库文件对应的预构建库模块的模块名</span>
<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>BUILD_SHARED_LIBRARY<span class="token punctuation">)</span>
</code></pre></div><div class="language-text ext-text"><pre class="language-text"><code>注意：
1. 在使用第三方库文件的其他模块中，通过变量 LOCAL_SHARED_LIBRARIES 或 LOCAL_STATIC_LIBRARIES 
   引入第三方库文件对应的预构建库模块的模块名。
   （若预构建库模块是通过 PREBUILT_SHARED_LIBRARY 声明，则通过变量 LOCAL_SHARED_LIBRARIES 引入）
   （若预构建库模块是通过 PREBUILT_STATIC_LIBRARY 声明，则通过变量 LOCAL_STATIC_LIBRARIES 引入）
</code></pre></div></li></ol><h4 id="_1-3-1-导出预构建库的头文件" tabindex="-1"><a class="header-anchor" href="#_1-3-1-导出预构建库的头文件" aria-hidden="true">#</a> 1.3.1 导出预构建库的头文件</h4><p>通常，第三方在提供库文件时，还会提供对应的暴露给外部调用的头文件。</p><p>此时，在声明预构建库模块时可以通过变量 <code>LOCAL_EXPORT_C_INCLUDES</code> 声明头文件的路径：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>CLEAR_VARS<span class="token punctuation">)</span>
LOCAL_MODULE <span class="token operator">:=</span> foo-prebuilt
LOCAL_SRC_FILES <span class="token operator">:=</span> libfoo.so
LOCAL_EXPORT_C_INCLUDES <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span>/<span class="token keyword">include</span> <span class="token comment"># 声明第三库文件对应的头文件路径</span>
<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>PREBUILT_SHARED_LIBRARY<span class="token punctuation">)</span>
</code></pre></div><p>于是，在使用预构建库的其他模块中，可以通过变量 <code>LOCAL_C_INCLUDES</code> 引入声明的头文件路径。</p><h3 id="_1-4-ndk-提供的函数宏" tabindex="-1"><a class="header-anchor" href="#_1-4-ndk-提供的函数宏" aria-hidden="true">#</a> 1.4 <code>NDK</code> 提供的函数宏</h3><p>本部分介绍了 <code>NDK</code> 提供的 <code>GNU Make</code> 函数宏。</p><p>使用 <code>$(call &lt;function&gt;)</code> 可以对其进行求值；其返回文本信息。</p><h4 id="_1-4-1-my-dir" tabindex="-1"><a class="header-anchor" href="#_1-4-1-my-dir" aria-hidden="true">#</a> 1.4.1 <code>my-dir</code></h4><p>这个宏返回最后包括的 <code>makefile</code> 的路径，通常是当前 <code>Android.mk</code> 的目录。</p><p><code>my-di</code>r 可用于在 <code>Android.mk</code> 文件开头定义 <code>LOCAL_PATH</code>。例如：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> my-dir<span class="token punctuation">)</span>
</code></pre></div><p>由于 <code>GNU Make</code> 的工作方式，这个宏实际返回的是构建系统解析构建脚本时包含的最后一个 <code>makefile</code> 的路径。因此，包括其他文件后就不应调用 <code>my-dir</code>。例如：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> my-dir<span class="token punctuation">)</span>

<span class="token comment"># ... declare one module</span>

<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span>/foo/`Android.mk`

LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> my-dir<span class="token punctuation">)</span>

<span class="token comment"># ... declare another module</span>
</code></pre></div><blockquote><p>这里的问题在于，对 <code>my-dir</code> 的第二次调用将 <code>LOCAL_PATH</code> 定义为 <code>$PATH/foo</code>，而不是 <code>$PATH</code>，因为这是其最近的 <code>include</code> 所指向的位置。</p></blockquote><p>在 <code>Android.mk</code> 文件中的任何其他内容后指定额外的 <code>include</code> 可避免此问题。例如：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> my-dir<span class="token punctuation">)</span>

<span class="token comment"># ... declare one module</span>

LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> my-dir<span class="token punctuation">)</span>

<span class="token comment"># ... declare another module</span>

<span class="token comment"># extra includes at the end of the Android.mk file</span>
<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span>/foo/Android.mk
</code></pre></div><p>如果以这种方式构造文件不可行，请将第一个 <code>my-dir</code> 调用的值保存到另一个变量中。例如：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code>MY_LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> my-dir<span class="token punctuation">)</span>

LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span>MY_LOCAL_PATH<span class="token punctuation">)</span>

<span class="token comment"># ... declare one module</span>

<span class="token keyword">include</span> <span class="token variable">$</span><span class="token punctuation">(</span>LOCAL_PATH<span class="token punctuation">)</span>/foo/`Android.mk`

LOCAL_PATH <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span>MY_LOCAL_PATH<span class="token punctuation">)</span>

<span class="token comment"># ... declare another module</span>
</code></pre></div><h4 id="_1-4-2-all-subdir-makefiles" tabindex="-1"><a class="header-anchor" href="#_1-4-2-all-subdir-makefiles" aria-hidden="true">#</a> 1.4.2 <code>all-subdir-makefiles</code></h4><p>返回位于当前 <code>my-dir</code> 路径所有子目录中的 <code>Android.mk</code> 文件列表。</p><p>利用此函数，您可以为构建系统提供深度嵌套的源目录层次结构。</p><blockquote><p>注意：默认情况下，<code>NDK</code> 只在 <code>Android.mk</code> 文件所在的目录中查找文件。</p></blockquote><h4 id="_1-4-3-this-makefile" tabindex="-1"><a class="header-anchor" href="#_1-4-3-this-makefile" aria-hidden="true">#</a> 1.4.3 <code>this-makefile</code></h4><p>返回当前 <code>makefile</code>（构建系统从中调用函数）的路径。</p><h4 id="_1-4-4-parent-makefile" tabindex="-1"><a class="header-anchor" href="#_1-4-4-parent-makefile" aria-hidden="true">#</a> 1.4.4 <code>parent-makefile</code></h4><p>返回包含树中父 <code>makefile</code> 的路径（包含当前 <code>makefile</code> 的 <code>makefile</code> 的路径）。</p><h4 id="_1-4-5-grand-parent-makefile" tabindex="-1"><a class="header-anchor" href="#_1-4-5-grand-parent-makefile" aria-hidden="true">#</a> 1.4.5 <code>grand-parent-makefile</code></h4><p>返回包含树中祖父 <code>makefile</code> 的路径（包含当前父 <code>makefile</code> 的 <code>makefile</code> 的路径）。</p><h4 id="_1-4-6-import-module" tabindex="-1"><a class="header-anchor" href="#_1-4-6-import-module" aria-hidden="true">#</a> 1.4.6 <code>import-module</code></h4><p>此函数用于按模块名称来查找和包含模块的 <code>Android.mk</code> 文件。典型的示例如下所示：</p><div class="language-makefile ext-makefile"><pre class="language-makefile"><code><span class="token variable">$</span><span class="token punctuation">(</span><span class="token function">call</span> import-module,&lt;name&gt;<span class="token punctuation">)</span>
</code></pre></div><blockquote><p>在此示例中，构建系统在 <code>NDK_MODULE_PATH</code> 环境变量所引用的目录列表中查找具有 <code>&lt;name&gt;</code> 标记的模块，并且自动包括其 <code>Android.mk</code> 文件。</p></blockquote><h2 id="_2-application-mk" tabindex="-1"><a class="header-anchor" href="#_2-application-mk" aria-hidden="true">#</a> 2. <code>Application.mk</code></h2><blockquote><p>参考：<a href="https://developer.android.google.cn/ndk/guides/application_mk?hl=zh-cn" target="_blank" rel="noopener noreferrer">Application.mk<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><!--]--></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/zengkaiqiang562/JavaGuide/edit/main/docs/zkq/android/ndk/ndk-build.md" rel="noopener noreferrer" target="_blank" arialabel="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" arialabelledby="edit"><title id="edit" lang="en">edit icon</title><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2022/7/18 18:01:37</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: zengkaiqiang562@163.com">zengk</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/zkq/android/ndk/jni.html" class="nav-link prev" arialabel="JNI"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->JNI</div></a><a href="/zkq/android/ndk/cmake.html" class="nav-link next" arialabel="CMake（TODO）"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">CMake（TODO）<!----></div></a></nav><!----><!----></main><!--]--><footer class="footer-wrapper"><div class="footer"></div><div class="copyright">Copyright © 2024 Zenk562</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.2a01fc36.js" defer></script>
  </body>
</html>
